<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>karriganasta&#39;s blog</title>
  
  <subtitle>infinite OI road.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-11-17T15:17:36.368Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>karriganasta</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NOIP2018æ¸¸è®°</title>
    <link href="http://yoursite.com/2018/11/17/NOIP2018%E6%B8%B8%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/11/17/NOIP2018æ¸¸è®°/</id>
    <published>2018-11-17T15:14:52.000Z</published>
    <updated>2018-11-17T15:17:36.368Z</updated>
    
    <content type="html"><![CDATA[<p>ç»ˆäºè”èµ›è€ƒå®Œå•¦</p><a id="more"></a><p>å¯èƒ½ä»Šå¹´åœ¨æ­å·è€ƒæœ‰buffå§ æ„Ÿè§‰è‡ªå·±è¿˜æ˜¯èœçš„å¸ƒæ˜Ÿ</p><p>å†ä¸å»æ¶¨å§¿åŠ¿åƒæ£è¯ä¸¸</p><p>æˆ‘æ ¡è¿™æ¬¡è€ƒçš„éƒ½å¾ˆç‰›é€¼å•Š <del>æˆ‘445ä¼¼ä¹åœ¨æˆ‘æ ¡é«˜ä¸€æ’rankå€’3</del></p><h4 id="Day-1"><a href="#Day-1" class="headerlink" title="Day -1"></a>Day -1</h4><p>æŒ‰ç…§æƒ¯ä¾‹è¿˜æ˜¯æ™šä¸Šè€ƒè¯• ä¼¼ä¹åˆæ˜¯zhxwmtçš„é¢˜ è¯¶è¿™ä¸ªé¢˜çš„éš¾åº¦æ€ä¹ˆè¿™ä¹ˆæ¸…å¥‡å•Š</p><p>æœç„¶æ˜¯ä¿¡å¿ƒåœº</p><p>æ™šä¸Šå¾—çŸ¥æ˜å¤©è¿˜è¦è€ƒè¯• å¿ƒç”Ÿä¸çˆ½ (å†è¿‡ä¸€å¤©å°±è”èµ›äº†è€ƒä¸ªğŸ”å„¿å•Š)</p><p>ç„¶åå¯¹ç€æŸè°·å¤ä¹ äº†å‡ ä¸ªæ¿å­ æ•²çš„æŒºå¿«</p><p>è¶…ä¸çŸ¥é“è‡ªå·±è¯¥å¹²å˜›</p><h4 id="Day-0"><a href="#Day-0" class="headerlink" title="Day 0"></a>Day 0</h4><p>ä¸Šåˆè€ƒè¯• ç„¶åä¸‰é“COCIåŸé¢˜</p><p>ä¸¤ä¸ªå°æ—¶å†™æ‰äº†T1 T2,T1å¤§æ ·ä¾‹çœŸå‘ T2å°±æ˜¯ä¸€ä¸ªå€å¢å°±å¥½äº†</p><p>çœ‹åˆ°T3 å¹³é¢çŸ©å½¢ ç„¶åä¸­å¤®æœ‰ä¸€ä¸ªå¢é•¿çš„æ­£æ–¹å½¢ æ±‚é¢ç§¯äº¤çš„å’Œ</p><p>çœŸç  æ ¹æœ¬ä¸æƒ³å†™ å°±200å§ äº¤äº†ç®—äº†</p><p>ç„¶åå¤§å®¶ä¼¼ä¹ä¸€èµ·æ¬¢ä¹åœ°åœ¨æ³¼éš”è†œå•Š</p><p>è‘£å…ˆç”Ÿçš„2048çœŸç¨³å•Š NBAçœŸå¥½çœ‹å•Š S8iGçœŸçŒ›å•Š è†œè›¤çœŸæœ‰è¶£å•Š</p><p>ç„¶ååä¸€ç‚¹åŠæ”¾äº† å›äº†è¶Ÿå®¶æ•´äº†ä¸‹è¡Œæ å»æ¥¼ä¸‹ä¹°äº†ä¸ªK æ‰“ç®—å¤§å·´è½¦ä¸Šå”</p><p>åè½¦ æƒ³å¼ºè¿«è‡ªå·±ç¡è§‰ å‘Šè¯‰è‡ªå·±ä¸è¦é¢“åºŸ</p><p>ç¡è§‰æœªæœ æ“äº†ä¼šå„¿ç‚‰çŸ³ æ ¸å¼¹ç‰§ç‰›é€¼</p><p>ç„¶åå°±ç¡ç€äº† ä¸­é—´éšéšçº¦çº¦èƒ½å¬åˆ°æµ·èœ‡çš„å‘å–Š:â€äº”æ€ æˆ‘çš„ äº”æ€ å•Šå•Šå“ˆå“ˆå“ˆâ€</p><p>å¤§å®¶ä¹ŸçœŸæ˜¯å¿ƒæ€å¥½å•Š æˆ‘è¿™ç§èŒæ–°å°±æ…Œçš„ä¸€æ‰¹</p><p>ä¸çŸ¥ä¸è§‰å°±å›åˆ°å‘å·äº† æœ‰ç‚¹å°æ€€å¿µå•Š å¾·èƒœçš„æ”¶è´¹ç«™å…¥å£ä¾ç„¶å µ</p><p>å‘å·è¿˜æ˜¯é‚£ä¸ªå‘å·å‘¢ </p><p>è¢«é€šçŸ¥å…ˆå»æŠ¥é“ äºæ˜¯è·Ÿç€å»äº†</p><p>å­¦å†›ç´«é‡‘æ¸¯ æœ‰é’±å•Š å†ä¸€æ¬¡æ„Ÿå—åˆ°äº†é•‡ä¸­ç¡¬ä»¶è®¾æ–½å’Œæœ‰é’±çš„å­¦è½¦çš„å·®è·</p><p>å‘ç‹—ç‰Œå•¦ è¢«åˆ†åˆ°æœºæˆ¿å»äº† æœç„¶ç»­å‘½é€‰æ‰‹å°±æ˜¯ä¸èƒ½å’Œåˆ«äººä¸€ä¸ªåœºé¦†å‘¢</p><p>åº§ä½å· D1 (ä½ ä¸ªå°é€¼å´½å­åˆåœ¨æš—ç¤ºæˆ‘)</p><p>å»é€›äº†ä¸‹å°å–éƒ¨å’Œæ ¡å›­ å’–å•¡å…éƒ½æœ‰ ç„¶åå¶é‡äº†ç‹æµ©ï¼Ÿ</p><p>æ™šé¥­åœ¨å­¦è½¦åƒ æ€»å…±å°±ä¸‰ä¸ªèœ æ²¡å¾—é€‰ ç³–é†‹é‡Œè„Š=ç³–é†‹é¢ç²‰ å·®è¯„</p><p>å›åˆ°é…’åº— ä»–ä»¬å…ˆå›å»çš„äººå› ä¸ºPAæŠŠæˆ¿å¡è½åœ¨å¤§å·´ä¸Šäº†æ‰€ä»¥åœ¨é‚£é‡Œç­‰äº†è¿‘ä¸¤ä¸ªå°æ—¶ ç»äº†</p><p>å’Œboomå¤§åˆ†åˆ°äº†ä¸€ä¸ªæˆ¿é—´å‘¢</p><p>å·²ç»æ˜¯ä¸ƒç‚¹äº† æƒ³ç€ç¬¬äºŒå¤©å°±è”èµ›äº† äºæ˜¯åˆä¸æ”¾å¿ƒåœ°å†™æ¿å­</p><p>å†™äº†ä¸ªæ ‘å‰– å†™äº†åŠä¸ªå°æ—¶ åˆè°ƒäº†ååˆ†é’Ÿæ‰å¯¹ è¿™ä¸ªé€Ÿåº¦ å”‰ æ²¡æ•‘äº†</p><p>æ™šä¸Šç”µå­äº§å“è¢«æ”¶èµ°å•¦ (<del>æ‰€ä»¥å·å·çœ‹äº†ä¼šå„¿ç”µè§†</del>)</p><h4 id="Day-1-1"><a href="#Day-1-1" class="headerlink" title="Day 1"></a>Day 1</h4><p>ç¬¬ä¸€æ¬¡è€ƒTGå‘¢ é¸¡å†»</p><p>å¯†ç æˆ‘è¾“äº†äº”æ¬¡æ‰å¯¹ å·®ç‚¹å°±å»é—®è€å¸ˆå¯†ç ä¸å¯¹äº† ä¸¢äºº</p><p>T1 å§æ§½å·®åˆ†ä¸€ä¸‹å°±æ²¡äº† 5minå†™å®Œ è¿‡å¤§æ ·ä¾‹ ä¸ç®¡äº†</p><p>æˆ‘å±…ç„¶å…ˆå¼€äº†T3</p><p>äºŒåˆ†ç­”æ¡ˆ+æ ‘ä¸Šè´ªå¿ƒï¼Ÿæ ¹èŠ‚ç‚¹å„¿å­æƒå€¼å†…æ‰¾æœ€å¤§åŒ¹é…æ•°ï¼Ÿç„¶åä¸è¡Œçš„æ‰¾ä¸€ä¸ªæœ€å¤§çš„ä¸¢ç»™ä»–çš„çˆ¶äº²ï¼Ÿè¿™ä¸ªä¼¼ä¹åŒæŒ‡é’ˆtwo pointerså°±å¥½äº†å•Š 30min å†™å®Œ</p><p>æ ·ä¾‹1 è¿‡äº† èˆ’æœ </p><p>æ ·ä¾‹2 è¿‡äº† èˆ’æœ</p><p>æ ·ä¾‹3 26175, ???</p><p>è¿™æ€ä¹ˆå†™æŒ‚??? æ‡µé€¼.jpg</p><p>ä¸Šäº†ä¸ªå•æ‰€å†·é™äº†ä¸€ä¸‹ æ„Ÿè§‰è‡ªå·±ä¸ä¼šæ˜¯è´ªå¿ƒæœ‰é—®é¢˜</p><p>äºæ˜¯æ¢äº†ä¸ªå§¿åŠ¿å†™two pointers è¿˜æ˜¯ 26175 </p><p><strong>ç„¶åæˆ‘å°±çœŸçš„ä»¥ä¸ºæˆ‘çš„è´ªå¿ƒ æ²¡æœ‰é—®é¢˜äº†</strong></p><p><strong>è€Œä¸”åæ¥çš„è°ƒè¯•éƒ½æ²¡æœ‰å»æ”¹è¿™ä¸ªè´ªå¿ƒçš„æœ¬è´¨ æˆ‘çš„åŒæŒ‡é’ˆåä¾‹éšä¾¿æ‰¾</strong></p><p><strong>æ¯”å¦‚è¿™ä¸ª å½“å‰äºŒåˆ†çš„å€¼ä¸º10 æœ‰ 4,7,9 æ˜¾ç„¶4,7ä¸€ç»„ æŠŠ9ä¸¢ä¸Šå»æ¯”è¾ƒå¥½ </strong></p><p><strong>ä½†æ˜¯æˆ‘åŒæŒ‡é’ˆå°±æŠŠ7ä¸¢ç»™äº†çˆ¶äº²</strong></p><p>ä¸æ…Œ è¿˜æœ‰ä¸¤ä¸ªåŠå°æ—¶ çœ‹T2å»</p><p>T2 è¿™è¯¥ä¸ä¼šæ˜¯æšä¸¾ä¸¤ä¸ªax + by = zç„¶åzå°±å¯ä»¥å»æ‰ exgcdå•Š å®Œäº†å¿˜äº†</p><p>å†·é™åˆ†æä¸€ä¸‹å°±æ˜¯ä¸ªèƒŒåŒ…å˜›.æœ¬æ¥åŠ äº†ä¸ªbitsetåæ¥æƒ³äº†æƒ³è¿˜æ˜¯ç¨³ä¸€ç‚¹å°±å»æ‰äº†</p><p>45minå†™å®Œ ä¸ç®¡äº† å›å¤´å†è¯´</p><p>T3 å„ç§å§¿åŠ¿æ¢ç€å†™ æœªæœ</p><p>æ€€ç–‘äººç”Ÿ <del>(ä¸ä¼šæ˜¯è¿™ä¸ªæ ·ä¾‹é”™äº†å§)</del></p><p>è¿™ç§çŠ¶æ€ä¸€ç›´æŒç»­åˆ°è€ƒè¯•ç»“æŸ</p><p>äº‹åå’Œåˆ«äººäº¤æµT3 å‘ç°æˆ‘è´ªå¿ƒå‡äº† åº”è¯¥å†å¥—äºŒåˆ†ä¸€ä¸ªå€¼å»æ‰¾å‘ä¸Šä¸¢çš„æœ€å¤§å€¼</p><p>å›é…’åº—å‘ç°ä¸€å †äºº <strong>AK</strong> äº† boomè¿™ä¸ªè´ªå¿ƒç”¨äº†ä¸ªmap ç„¶åå¸¸æ•°å°±å¤§çš„ä¸è¡Œ</p><p>50000 $nlog^3n$ è¢«å¡äº† æƒ¨å•Š</p><p>æˆ‘åæ­£å°±ç„å­¦å¾—åˆ†äº† $100 + 100 +???$</p><p>ç¥çŠ‡ä¸­åˆé›†ä¸­Däºº åœºé¢ç”šæ˜¯å£®è§‚</p><p>ä¸‹åˆå¤§å®¶éƒ½æ³¼çš„æŒºå¼€å¿ƒçš„å•Š çœ‹åˆ°ç‹å°Šäº†å‘¢</p><p>szkçšæœˆæ‰“é‡çœŸå¼ºå•Š </p><p>æ™šä¸Šå¤ä¹ äº†fhq-Treap å»å¹´D2T3è€ƒäº†ä¸ªå¹³è¡¡æ ‘ æ…Œçš„ä¸€æ‰¹</p><p>å†™äº†äºŒååˆ†é’Ÿ æœ€åå‘ç°è‡ªå·± <code>inline int merge(int x,int y)</code>å†™æŒ‚äº†</p><h4 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h4><p>å¼€åœº å¯†ç ä¸€æ¬¡å¯¹äº† èˆ’æœ</p><p>ä»Šå¤©å°±å°½é‡æ‹¿åˆ†å§</p><p>çœ‹é¢˜ T1ä¸€çœ¼ $O(n^2)$ ååˆ†å¯å†™</p><p>T2 æ˜¯ä¸ªæ¨æŸ¿å­çš„å¥½é¢˜å•Š ä½†æ˜¯è¿™ä¸ªé¢˜ æ¨å‡ºæ¥å°±A æ¨ä¸å‡ºæ¥å¯èƒ½å°±è¦æ»šç²—å•Š</p><p>T3 ä»€ä¹ˆï¼ŸåŠ¨æ€DPæ¨¡æ¿ï¼Ÿ ä»æ¥æ²¡å†™è¿‡ å…ˆä¸¢ç€ä¸ç®¡</p><p>å¼€å§‹å†™T1 æ‰¾ç¯å°± $tarjan$ å§ æš´åŠ›å°±å®Œäº‹äº† ç„¶åæšä¸¾ä¸€ä¸‹åˆ æ‰çš„è¾¹</p><p>50minå†™å®Œ+è°ƒè¯•</p><p>T2 é¢˜æ„ æˆ‘ç†è§£äº†ä¸€ä¸ªä¸–çºª</p><p>$n = 2$ å—¯å‚»é€¼å®¹æ–¥</p><p>$n = 3$ å—¯ ï¼Ÿï¼Ÿï¼Ÿ</p><p>å°è¯•æ¨å¹¿äº†ä¸€æ³¢ æœªæœ</p><p>æ¯”è¾ƒåæ‚”çš„æ˜¯æ²¡æœ‰å»å†™ é‚£ä¸ª$n,m &lt;= 8$çš„çŠ¶å‹</p><p>æ¨äº†ä¸¤ä¸ªå°æ—¶ å‘ç°å†™å‡ºæ¥å’Œé‚£ä¸ªå®¹æ–¥ä¸ä¸€æ · å¿ƒæ€å´©äº† è¿˜æœ‰40min</p><p>ç®—äº†T2 50ptså§ å»æ‹¿T3çš„40pts</p><p>å†™å®Œ è¿‡äº†ç¬¬ä¸€ä¸ªæ ·ä¾‹ è¿˜æœ‰ååˆ†é’Ÿäº† èµ¶ç´§å»æ£€æŸ¥T1 T2 æ–‡ä»¶å</p><p>äºæ˜¯å°±é¢„æœŸ$100 +50 +40$äº†</p><p>å‡ºè€ƒåœºå‘ç°å¤§å®¶éƒ½è‡ªé—­äº† ä»Šå¹´è¿™ä¸ªéš¾åº¦æ’å¸ƒ æ’ç‰ˆçš„ç»å¯¹æ˜¯ä¸ªç¿æ™º</p><p>æ­å·å‘†äº†ä¸€å¤©å°±æ»šå›å»å­¦æ–‡åŒ–è¯¾å•¦</p><h4 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h4><p>Day1T3 æˆ‘æ´›è°·æ•°æ®95pts å­¦å†›å±±å¯¨æ•°æ®100 é•‡ä¸­æ•°æ®90</p><p>æˆ‘:??? boom:???</p><p>Day2T3 çˆ†é›¶ æš´åŠ›å†™æŒ‚ æ²¡è°äº†</p><p>äºæ˜¯ç°åœ¨çš„åˆ†æ•°é¢„æœŸ</p><p>$100 + 100 + 95 + 100 + 50 +0$</p><p>è¿˜å¯ä»¥æ›´å¥½çš„å•Šâ€¦</p><p>lyx_cjz qiqi20021026 yhx12243 skylee03 bestFy _Chenkerui zjd dwt scx zzs boom GCC314 zzrh ç‰›é€¼ï¼</p><p><em>è¦æˆä¸ºæ¸©æŸ”çš„äººå•Š</em></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»ˆäºè”èµ›è€ƒå®Œå•¦&lt;/p&gt;
    
    </summary>
    
      <category term="æ¸¸è®°" scheme="http://yoursite.com/categories/%E6%B8%B8%E8%AE%B0/"/>
    
    
      <category term="æ¸¸è®°" scheme="http://yoursite.com/tags/%E6%B8%B8%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒBZOJ3123 / SDOI2013ã€ æ£®æ— ä¸»å¸­æ ‘+DSU ON TREE</title>
    <link href="http://yoursite.com/2018/09/22/%E3%80%8CBZOJ3123-SDOI2013%E3%80%8D-%E6%A3%AE%E6%9E%97-%E4%B8%BB%E5%B8%AD%E6%A0%91-DSU-ON-TREE/"/>
    <id>http://yoursite.com/2018/09/22/ã€ŒBZOJ3123-SDOI2013ã€-æ£®æ—-ä¸»å¸­æ ‘-DSU-ON-TREE/</id>
    <published>2018-09-22T04:24:07.000Z</published>
    <updated>2018-09-22T04:53:35.320Z</updated>
    
    <content type="html"><![CDATA[<p> å†™æ¯’ç˜¤ å­¦å¥—è·¯ .</p><p>Links there:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3123" target="_blank" rel="noopener">BZOJ3123</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æœ‰ä¸€ä¸ª $N$ ç»“ç‚¹çš„æ£®æ— æ¯ä¸€ä¸ªç»“ç‚¹æœ‰ä¸€ä¸ªéè´Ÿæƒå€¼ åˆå§‹çš„æ—¶å€™æœ‰ $M$ æ¡è¾¹. æœ‰ $T$ ä¸ªæ“ä½œ.</p><p>è¯·æ”¯æŒä¸‹é¢ä¸¤ä¸ªæ“ä½œ å¼ºåˆ¶åœ¨çº¿</p><blockquote><p>1 $Q$ $x$ $y$ $k$ æŸ¥è¯¢ç‚¹ $x$ åˆ°ç‚¹ $y$ ä¸Šç¬¬ $k$ å°çš„æƒå€¼ ä¿è¯è¾“å…¥åˆæ³•</p><p>2 $L$ $x$ $y$ åœ¨ $x$ å’Œ $y$ ä¹‹é—´è¿è¾¹ è¿å®Œè¾¹åä¿è¯è¿˜æ˜¯æ£®æ—.</p></blockquote><p>$N,M,T \leq 80000$</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å…ˆå¯¹äºæ‰€æœ‰å‡ºç°çš„å€¼ç¦»æ•£åŒ–</p><p>å¯¹äºç¬¬ä¸€ä¸ªæ“ä½œè€ƒè™‘å¯¹æ¯ä¸ªè”é€šå—å¼€ä¸€ä¸ªä¸»å¸­æ ‘æ¯æ¬¡æ–°åŠ ç»“ç‚¹å°±ç»§æ‰¿$father$çš„ä¿¡æ¯.</p><p>æ¯æ¬¡æŸ¥è¯¢çš„æ—¶å€™åœ¨ $x$ $y$ $lca(x,y)$ $fa(lca(x,y))$ ä¸Šè·‘äºŒåˆ†</p><p>è¿™æ ·çš„å¤æ‚åº¦æ˜¯ $O(nlog^2n)$ çš„.</p><p>å¯¹äºç¬¬äºŒä¸ªæ“ä½œæ¥è¯´ è¿™ç§åªæœ‰è¿è¾¹æ²¡æœ‰æ–­è¾¹ ç”¨ $Link CutTree$ å¯ä»¥åšåˆ° $nlogn$ ä½†æ˜¾ç„¶ç»™è‡ªå·±åŠ å¤§äº†ä»£ç å¤æ‚åº¦ æˆ‘ä»¬è€ƒè™‘å¯å‘å¼åˆå¹¶ è®°å½•æ¯ä¸ªè”é€šå—çš„ $fa$ å’Œ $size$ æ¯æ¬¡è¿è¾¹çš„æ—¶å€™ç”¨å¹¶æŸ¥é›†å»æŸ¥å“ªä¸ªè”é€šå¿«çš„ $size$ æ›´å¤§ç„¶åæš´åŠ›é‡æ–°è®¡ç®— $ST$ è¡¨å³å¯ è¿™æ ·çš„å¤æ‚åº¦ä¹Ÿæ˜¯ $O(nlog^2n)$ çš„.</p><p>æ€»å¤æ‚åº¦ $O(nlog^2n)$ å¯ä»¥åƒåœ¾å›æ”¶ä½†æ²¡å¿…è¦.</p><h3 id="Code-äººä¸‘ä»£ç é•¿"><a href="#Code-äººä¸‘ä»£ç é•¿" class="headerlink" title="Code(äººä¸‘ä»£ç é•¿)"></a>Code(äººä¸‘ä»£ç é•¿)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//What is broken can be reforged. --Riven</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">NextChar</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;<span class="keyword">char</span> c;<span class="keyword">for</span>(c=getchar();!<span class="built_in">isalpha</span>(c);c=getchar()); <span class="keyword">return</span> c;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">8e4</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXNODE = <span class="number">1e7</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> root[MAXN],lson[MAXNODE],rson[MAXNODE],sz[MAXNODE],n,m,T,fa[MAXN],k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> head[MAXN],cnt = <span class="number">0</span>,cntt = <span class="number">0</span>,st[MAXN][<span class="number">20</span>],a[MAXN],b[MAXN],sum[MAXN],dep[MAXN],vis[MAXN],nn;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;lt[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;lt[u].pb(v);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Getid</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> lower_bound(b+<span class="number">1</span>,b+nn+<span class="number">1</span>,x)-b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x == fa[x] ? x : fa[x] = getf(fa[x]);&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;dustbin;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Newnode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dustbin.empty()) <span class="keyword">return</span> ++cnt;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> u = dustbin.front();</span><br><span class="line">        dustbin.pop();</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    lson[u] = rson[u] = sz[u] = <span class="number">0</span>;</span><br><span class="line">    dustbin.push(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">decline</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!u) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l != r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        decline(lson[u],l,mid);</span><br><span class="line">        decline(rson[u],mid+<span class="number">1</span>,r);</span><br><span class="line">    &#125;</span><br><span class="line">    Dec(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;k,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    k = Newnode();</span><br><span class="line">    sz[k] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(lson[k],l,mid);</span><br><span class="line">    build(rson[k],mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> &amp;k,<span class="keyword">int</span> pre,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    k = Newnode();</span><br><span class="line">    sz[k] = sz[pre] + <span class="number">1</span>;</span><br><span class="line">    lson[k] = lson[pre]; rson[k] = rson[pre];</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= mid) ins(lson[k],lson[pre],l,mid,x);</span><br><span class="line">    <span class="keyword">else</span> ins(rson[k],rson[pre],mid+<span class="number">1</span>,r,x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> x1,<span class="keyword">int</span> y1,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> b[l];</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> tmp = sz[lson[x]] + sz[lson[y]] - sz[lson[x1]] - sz[lson[y1]];</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= tmp) <span class="keyword">return</span> query(lson[x],lson[y],lson[x1],lson[y1],l,mid,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(rson[x],rson[y],rson[x1],rson[y1],mid+<span class="number">1</span>,r,k-tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> father,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    ++sum[rt]; st[u][<span class="number">0</span>] = fa[u] = father; dep[u] = dep[father]+<span class="number">1</span>; vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">18</span>; ++i)</span><br><span class="line">        st[u][i] = st[st[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    <span class="comment">//Dec(root[u]);</span></span><br><span class="line">    root[u] = <span class="number">0</span>;</span><br><span class="line">    ins(root[u],root[father],<span class="number">1</span>,nn,Getid(a[u]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lt[u].size(); ++i) &#123;</span><br><span class="line">        <span class="comment">//printf("%lld\n",v);</span></span><br><span class="line">        <span class="keyword">int</span> v = lt[u][i];</span><br><span class="line">        <span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v,u,rt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y]) swap(x,y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (dep[st[y][i]] &gt;= dep[x])  y = st[y][i];</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (st[x][i] != st[y][i]) &#123;</span><br><span class="line">            x = st[x][i]; y = st[y][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> st[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// freopen("1.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("1.ans","w",stdout);</span></span><br><span class="line">    <span class="keyword">int</span> hjqmy = read();</span><br><span class="line">    hjqmy = <span class="number">1</span>;T = hjqmy;</span><br><span class="line">    n =  read(),m = read(),T = read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        b[i] = read();</span><br><span class="line">        a[i] = b[i];</span><br><span class="line">        fa[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line">    nn = unique(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line">    <span class="comment">//rep(i,1,nn) printf("%lld\n",b[i]);</span></span><br><span class="line">    rep(i,<span class="number">1</span>,m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = read(),y = read();</span><br><span class="line">        addedge(x,y);addedge(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">    build(root[<span class="number">0</span>],<span class="number">1</span>,nn);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)  <span class="keyword">if</span> (!vis[i]) dfs(i,<span class="number">0</span>,i),fa[i] = i;</span><br><span class="line">    <span class="comment">//for (int i = 1; i &lt;= n; ++i) printf("%lld ",dep[i]);</span></span><br><span class="line">    <span class="comment">//for (int x,y;;) x=read(),y=read(),printf("%lld\n",LCA(x,y));</span></span><br><span class="line">    <span class="keyword">int</span> lastans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(T--) &#123;</span><br><span class="line">        <span class="keyword">char</span> c = NextChar();</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'Q'</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = read()^lastans,y = read()^lastans,K = read()^lastans,x1 = LCA(x,y),y1 = st[x1][<span class="number">0</span>];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,lastans = query(root[x],root[y],root[x1],root[y1],<span class="number">1</span>,nn,K));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> x = read()^lastans,y = read()^lastans;</span><br><span class="line">            addedge(x,y); addedge(y,x);</span><br><span class="line">            <span class="keyword">int</span> fax = getf(x),fay = getf(y);</span><br><span class="line">            <span class="keyword">if</span> (sum[fax] &gt; sum[fay]) swap(x,y),swap(fax,fay);</span><br><span class="line">            dfs(x,y,fay);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt; å†™æ¯’ç˜¤ å­¦å¥—è·¯ .&lt;/p&gt;
&lt;p&gt;Links there:&lt;a href=&quot;https://www.lydsy.com/JudgeOnline/problem.php?id=3123&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BZOJ3123&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="ä¸»å¸­æ ‘" scheme="http://yoursite.com/categories/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="DSUå¯å‘å¼åˆå¹¶" scheme="http://yoursite.com/categories/DSU%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒBZOJ5311 / CF321Eã€ è´é±¼ WQSäºŒåˆ†+å†³ç­–å•è°ƒä¼˜åŒ– DP</title>
    <link href="http://yoursite.com/2018/09/22/%E3%80%8CBZOJ5311-CF321E%E3%80%8D-%E8%B4%9E%E9%B1%BC-WQS%E4%BA%8C%E5%88%86-%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E4%BC%98%E5%8C%96-DP/"/>
    <id>http://yoursite.com/2018/09/22/ã€ŒBZOJ5311-CF321Eã€-è´é±¼-WQSäºŒåˆ†-å†³ç­–å•è°ƒä¼˜åŒ–-DP/</id>
    <published>2018-09-22T04:22:31.000Z</published>
    <updated>2018-09-22T04:50:59.287Z</updated>
    
    <content type="html"><![CDATA[<p>å½“å†³ç­–å•è°ƒä¸WQSäºŒåˆ†ç»“åˆ.</p><p>Links there:<a href="http://codeforces.com/contest/321/problem/E" target="_blank" rel="noopener">CF321E</a> <a href="https://www.lydsy.com/JudgeOnline/problem.php?id=5311" target="_blank" rel="noopener">bzoj5311</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ $n$ æ¡è´é±¼ä¸æ¯å¯¹è´é±¼ä¹‹é—´çš„æ€¨æ°”å€¼ æ±‚åˆ†æˆ $K$ æ®µ,æ¯æ®µçš„æ€¨æ°”å€¼ä¹‹å’Œçš„æœ€å°å€¼.</p><p>$1 \leq n \leq 4000, 1 \leq k \leq min(n,800)$</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å…ˆæƒ³æœ´ç´ çš„ $dp$.ä¸éš¾æƒ³åˆ°è¿™ä¸ª $O(n^2k)$ çš„è½¬ç§»</p><script type="math/tex; mode=display">f(i,k) = min{(f[j][k-1] + calc(j,i))}</script><p>å…¶ä¸­ $calc(i,j)$ åˆ©ç”¨å‰ç¼€å’Œåšä¸€ä¸‹å°±å¥½äº†.æ˜¾ç„¶è·‘ä¸è¿‡å».</p><p>ç±»ä¼¼ $JSOI2011 Lemon$ ,å‡è®¾æœ‰ $k &lt; j \leq i$ ,æˆ‘ä»¬å‘ç°å¦‚æœæœ‰ $j$ åœ¨æŸä¸ªæ—¶åˆ»æ¯” $k$ ä¼˜ç§€é‚£ä¹ˆå®ƒæ°¸è¿œæ¯” $k$ ä¼˜ç§€.å› ä¸º$f[j]  + calc(j,i) &gt; f[k] + calc(k,i)$ , $f[j] - f[k] &gt; calc(k,i) - calc(j,i) &gt; 0$</p><p>ä½†æ˜¯ä¸èƒ½æ–œç‡ä¼˜åŒ– å› ä¸ºå³è¾¹çš„å¼å­åœ¨æ¢äº†å†³ç­–ç‚¹ä¹‹å å¹¶ä¸ä¸€å®šå•è°ƒ.</p><p>æä¸€ä¸ªå•è°ƒé˜Ÿåˆ— åˆæ˜¯ç±»ä¼¼ $JSOI2011 Lemon$ ,ä¿è¯æ›´ä¼˜ç§€çš„ç­”æ¡ˆå‡ºç°çš„æ—¶é—´å•è°ƒ æ¯æ¬¡äºŒåˆ†å»æ‰¾.</p><p>ç„¶åæˆ‘ä»¬æˆåŠŸä¼˜åŒ–åˆ°äº† $O(nlognk)$</p><p>å‘ç°è¿˜æ˜¯è¿‡ä¸å» ä¸ºä»€ä¹ˆå‘¢</p><p><strong>è¯»å…¥å¤ªå¤§äº†</strong></p><p>å†è€ƒè™‘ä¸€ä¸ªä¼˜åŒ– è§‚å¯Ÿåˆ°è¿™é‡Œçš„é™åˆ¶æ˜¯æ°å¥½ $K$ æ®µ</p><p>ç”¨ $WQS$ äºŒåˆ†çš„å¥—è·¯ æ¯æ¬¡é€‰ä¸€æ®µçš„æ—¶å€™åŠ ä¸€ä¸ªæ€¨æ°”å€¼ è®°å½•æœ€åé€‰äº†å‡ æ®µ.</p><p>å‘ç°å¦‚æœè¿™ä¸ªé™„åŠ æ€¨æ°”å€¼è¶Šå°çš„è¯å¯¹äºå›ºå®šçš„ $i$ æ€»æ®µæ•°è¶Šå¤§.</p><p>ç„¶åç­”æ¡ˆè¿˜åŸå½±å“å°±å¯ä»¥äº†.</p><p>æ³¨æ„äºŒåˆ†çš„è¾¹ç•Œ è¿™ç©æ„ä¸æ˜¯ä¸€èˆ¬çš„å‘</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Keep pluggin',this is your only outlet.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> buf[<span class="number">1</span>&lt;&lt;<span class="number">16</span>],*S,*T;</span><br><span class="line">    <span class="keyword">if</span>(S==T)&#123;T=(S=buf)+fread(buf,<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">16</span>,<span class="built_in">stdin</span>);<span class="keyword">if</span>(T==S) <span class="keyword">return</span> EOF;&#125;</span><br><span class="line">    <span class="keyword">return</span> *S++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=gc();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=gc();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=gc();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e3</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[MAXN][MAXN],m,pre[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> f[MAXN],c[MAXN],q[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f[x] + ((pre[y][y] - pre[x][y] - pre[y][x] + pre[x][x]) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">isbetter</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> w1 = calc(x,t),w2 = calc(y,t);</span><br><span class="line">    <span class="keyword">if</span> (w1 &gt; w2) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (w2 &gt; w1) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> (c[x] &gt;= c[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Tim</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123; <span class="comment">//the pos decision x is better than y</span></span><br><span class="line">    <span class="keyword">int</span> l = y + <span class="number">1</span>,r = n,mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r) &#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (isbetter(x,y,mid)) r = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r + <span class="number">1</span>; <span class="comment">// +1 is the valid place.</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">isok</span><span class="params">(<span class="keyword">int</span> mid)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> head = <span class="number">1</span>,tail = <span class="number">1</span>;</span><br><span class="line">    q[head] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head &lt; tail &amp;&amp; isbetter(q[head],q[head+<span class="number">1</span>],i)) ++head;</span><br><span class="line">        f[i] = calc(q[head],i) + mid;</span><br><span class="line">        c[i] = c[q[head]] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(head &lt; tail &amp;&amp; Tim(q[tail<span class="number">-1</span>],q[tail]) &gt; Tim(q[tail],i)) --tail;</span><br><span class="line">        q[++tail] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c[n] &lt;= m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n = read(),m = read();</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,n)</span><br><span class="line">        rep(j,<span class="number">1</span>,n) &#123;</span><br><span class="line">            a[i][j] = read();</span><br><span class="line">            pre[i][j] = pre[i<span class="number">-1</span>][j] + pre[i][j<span class="number">-1</span>] - pre[i<span class="number">-1</span>][j<span class="number">-1</span>] + a[i][j]; <span class="comment">//prefix sum</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">0</span>,R = pre[n][n] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(L &lt;= R) &#123;</span><br><span class="line">        <span class="comment">// printf("%lld %lld\n",L,R);</span></span><br><span class="line">        <span class="keyword">int</span> mid = (L+R) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// printf("%lld\n",mid);</span></span><br><span class="line">        <span class="keyword">if</span> (isok(mid)) &#123;ans = f[n] - mid * m; R = mid - <span class="number">1</span>;&#125;</span><br><span class="line">        <span class="keyword">else</span> L = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å½“å†³ç­–å•è°ƒä¸WQSäºŒåˆ†ç»“åˆ.&lt;/p&gt;
&lt;p&gt;Links there:&lt;a href=&quot;http://codeforces.com/contest/321/problem/E&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CF321E&lt;/a&gt; &lt;a href=&quot;https://www.lydsy.com/JudgeOnline/problem.php?id=5311&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;bzoj5311&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="WQSäºŒåˆ†" scheme="http://yoursite.com/categories/WQS%E4%BA%8C%E5%88%86/"/>
    
      <category term="DP-å†³ç­–å•è°ƒä¼˜åŒ–DP" scheme="http://yoursite.com/categories/DP-%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E4%BC%98%E5%8C%96DP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒBZOJ4709 / JSOI2011ã€ æŸ æª¬ å†³ç­–å•è°ƒä¼˜åŒ–DP</title>
    <link href="http://yoursite.com/2018/09/22/%E3%80%8CBZOJ4709-JSOI2011%E3%80%8D-%E6%9F%A0%E6%AA%AC-%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E4%BC%98%E5%8C%96DP/"/>
    <id>http://yoursite.com/2018/09/22/ã€ŒBZOJ4709-JSOI2011ã€-æŸ æª¬-å†³ç­–å•è°ƒä¼˜åŒ–DP/</id>
    <published>2018-09-22T04:21:05.000Z</published>
    <updated>2018-09-22T04:49:42.640Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç°è‡ªå·±å¯¹ $DP$ ä¼˜åŒ–ä¸€æ— æ‰€çŸ¥.</p><p>Links there:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=4709" target="_blank" rel="noopener">BZOJ-4709</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æœ‰ $N$ ä¸ªè´å£³,æ¯ä¸ªè´å£³æœ‰é¢œè‰² $s_i$ å¯ä»¥å–è‹¥å¹²æ®µçš„è´å£³å¹¶æ¯æ¬¡æŒ‡å®šä¸€ä¸ªé¢œè‰² $x$ ,å®šä¹‰åœ¨æ¯ä¸ªé€‰æ‹©çš„åŒºé—´å†…å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º $x \times t[x]^2$ ,å…¶ä¸­ $t[x]$ ä¸ºåœ¨è¿™ä¸€æ®µä¸­é¢œè‰² $x$ çš„å‡ºç°æ¬¡æ•°</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å…ˆè¦æƒ³ä¸€ä¸ªç»“è®º:</p><p>å‡è®¾æ¯æ¬¡å–çš„åŒºé—´ä¸º $[L,R]$ é‚£ä¹ˆå¿…å®šæœ‰ $s_L = s_R$ ,ä¹Ÿå°±æ˜¯ä¸¤ç«¯é¢œè‰²ç›¸åŒ.è¿™æ ·å–ä¸€å®šæ˜¯æœ€ä¼˜çš„.</p><p>å¦‚æœä¸¤ç«¯é¢œè‰²ä¸ä¸€æ ·çš„è¯ é‚£ä¹ˆè¿™ä¸€ç‚¹å¯ä»¥å½’åˆ°å·¦è¾¹æˆ–è€…å½’åˆ°å³è¾¹ è€Œä¸”å¯¹å•å•è¿™ä¸€æ®µçš„ç­”æ¡ˆæ²¡æœ‰å½±å“ æ‰€ä»¥æ­£ç¡®æ€§æ˜¾ç„¶ è¿™æ ·æ‰¾çš„ä¸€å®šæœ€å¤§</p><p>é‚£ä¹ˆè®°å½• $c[i]$ ä¸ºé¢œè‰² $s_i$ ä»å¼€å§‹å‡ºç°åˆ°ç°åœ¨çš„æ¬¡æ•° æ˜¾ç„¶æœ‰è½¬ç§»</p><script type="math/tex; mode=display">f[i] =max(f[j-1],a[i] *{(s[i]-s[j]+1)}^2)</script><p>è¿™æ ·çš„å¤æ‚åº¦æ˜¯ $O(n^2)$ çš„.</p><p>è€ƒè™‘ä¼˜åŒ– æ˜¾ç„¶ä¸èƒ½æ–œç‡ä¼˜åŒ– å› ä¸ºå¯¹äº $i&lt;j$ , $i$ çš„å†³ç­–ä¼šå½±å“åˆ° $j$ çš„å†³ç­–</p><p>è§‚å¯Ÿè½¬ç§»æ–¹ç¨‹ å‘ç°å¦‚æœè¯´æœ‰ $k &lt; j  \leq i$ å‡å¦‚ $k$ çš„è½¬ç§»è¦æ¯” $j$ ä¼˜ç§€,é‚£ä¹ˆåœ¨åé¢çš„è½¬ç§»ä¸­ $j$ æ˜¯ä¸€å®šç”¨ä¸åˆ°çš„ å› ä¸ºå¹³æ–¹ä¼šè¶Šæ¥è¶Šå¤§ å› æ­¤å¯ä»¥å¯¹æ¯ä¸€ä¸ªé¢œè‰²å¼€ä¸€ä¸ªæ ˆ æ¯æ¬¡å‘ç°æ ˆé¡¶çš„æ²¡æœ‰ä¸‹é¢é‚£ä¸ªè½¬ç§»ä¼˜ç§€å°±æŠŠä»–å¼¹æ‰.</p><p><del>ç„¶åä½ å°±å‘ç°ä½ WAäº†</del></p><p>å› ä¸ºè¿™ä¹ˆåšåªèƒ½ä¿è¯è¢«å¼¹æ‰çš„ä¸å†æœ‰ç”¨ ä½†æˆ‘ä»¬æ±‚çš„æ˜¯æœ€å¤§å€¼ æ— æ³•ä¿è¯æ ˆé¡¶çš„ä¸€å®šæœ€ä¼˜ç§€ æ¯”å¦‚å‡ºç°æ ˆä¸­ç¬¬ä¸‰ä¸ªæ›´ä¼˜ç§€çš„æƒ…å†µ.</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±è¦ä»å…¥æ ˆæ—¶é—´æ¥æƒ³ ä»ç„¶å‡è®¾ $k &lt; j  \leq i$ ,æˆ‘ä»¬å‡å®š $k$ è½¬ç§»åœ¨ $k_1$ ä¼˜äº $i$ ,$j$ åœ¨ $j_1$ ä¼˜äº</p><p>$i$ å¦‚æœæœ‰ $k_1 &lt; j_1$ ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢.</p><p>ä»”ç»†æ¨¡æ‹Ÿä¹‹åæˆ‘ä»¬å‘ç° æ ˆä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ¯”ç¬¬äºŒä¸ªä¼˜ç§€,è€Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªæ›´ä¼˜ç§€çš„ $k_1$ æˆ‘ä»¬æ²¡æŠŠå®ƒå–å‡ºæ¥.</p><p>è¿™å°±æ˜¯ä¸‡æ¶ä¹‹æº å› æ­¤é‡åˆ° $k_1 &lt; j_1$ çš„æƒ…å†µ å°±å¼¹å‡º ä¿è¯æ ˆå†…å…ƒç´ æ¯”ä¸Šä¸€ä¸ªå…ƒç´ æ›´ä¼˜çš„æ—¶é—´ä¹Ÿæ˜¯å•è°ƒçš„ å› æ­¤äºŒåˆ†å»æ‰¾è¿™ä¸ª â€œæ›´ä¼˜æ—¶é—´â€ å°±è¡Œå•¦.</p><p>å¤æ‚åº¦$O(nlogn)$ å¯ä»¥æè¿‡å».</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Keep pluggin',this is your only outlet.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickmul</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> mod)</span></span>&#123;<span class="keyword">return</span> (x*y-(<span class="keyword">int</span>)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;sta[MAXN];</span><br><span class="line"><span class="keyword">int</span> n,col[MAXN],a[MAXN],f[MAXN],c[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Calc</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f[x<span class="number">-1</span>] + (c[y]-c[x]+<span class="number">1</span>) * (c[y]-c[x]+<span class="number">1</span>) * a[y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Tim</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>,r = n,mid,cur = (c[y] - c[x]);</span><br><span class="line">    <span class="keyword">while</span>(l &lt; r) &#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (f[x<span class="number">-1</span>] + (mid + cur) * (mid + cur) * a[x] &lt; f[y<span class="number">-1</span>] + mid * mid * a[y])</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> r = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n = read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n) a[i] =  read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        c[i] = ++col[a[i]];</span><br><span class="line">        <span class="keyword">while</span>((<span class="keyword">signed</span>)sta[a[i]].size()&gt;=<span class="number">2</span> &amp;&amp; Tim(sta[a[i]][(<span class="keyword">signed</span>)sta[a[i]].size()<span class="number">-2</span>],i) &lt; Tim(sta[a[i]][(<span class="keyword">signed</span>)sta[a[i]].size()<span class="number">-1</span>],i))</span><br><span class="line">            sta[a[i]].pop_back();</span><br><span class="line">        sta[a[i]].push_back(i);</span><br><span class="line">        <span class="keyword">while</span>((<span class="keyword">signed</span>)sta[a[i]].size()&gt;=<span class="number">2</span> &amp;&amp; Calc(sta[a[i]][(<span class="keyword">signed</span>)sta[a[i]].size()<span class="number">-2</span>],i) &gt; Calc(sta[a[i]][(<span class="keyword">signed</span>)sta[a[i]].size()<span class="number">-1</span>],i))</span><br><span class="line">        sta[a[i]].pop_back();</span><br><span class="line">        f[i] = Calc(sta[a[i]][sta[a[i]].size()<span class="number">-1</span>],i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sta[a[i]].size()<span class="number">-1</span>; ++j)</span><br><span class="line">            f[i] = max(f[i],Calc(sta[a[i]][j],i));</span><br><span class="line">        <span class="comment">//printf("%lld\n",f[i]);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç°è‡ªå·±å¯¹ $DP$ ä¼˜åŒ–ä¸€æ— æ‰€çŸ¥.&lt;/p&gt;
&lt;p&gt;Links there:&lt;a href=&quot;https://www.lydsy.com/JudgeOnline/problem.php?id=4709&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BZOJ-4709&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="DP-å†³ç­–å•è°ƒä¼˜åŒ–DP" scheme="http://yoursite.com/categories/DP-%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E4%BC%98%E5%8C%96DP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒBZOJ3622 ã€å·²ç»æ²¡æœ‰ä»€ä¹ˆå¥½å®³æ€•çš„äº† å®¹æ–¥ DP</title>
    <link href="http://yoursite.com/2018/09/22/%E3%80%8CBZOJ3622-%E3%80%8D%E5%B7%B2%E7%BB%8F%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E5%A5%BD%E5%AE%B3%E6%80%95%E7%9A%84%E4%BA%86-%E5%AE%B9%E6%96%A5-DP/"/>
    <id>http://yoursite.com/2018/09/22/ã€ŒBZOJ3622-ã€å·²ç»æ²¡æœ‰ä»€ä¹ˆå¥½å®³æ€•çš„äº†-å®¹æ–¥-DP/</id>
    <published>2018-09-22T04:18:36.000Z</published>
    <updated>2018-09-22T04:32:40.422Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3622" target="_blank" rel="noopener">BZOJ3622</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æœ‰ $N$ ä¸ªè¯å’Œç³– æ¯ä¸ªè¯å’Œç³–éƒ½æœ‰è‡ªå·±çš„èƒ½é‡ ä»–ä»¬ä¹‹é—´å¯ä»¥ä¸¤ä¸¤é…å¯¹ æ±‚ç³–çš„èƒ½é‡æ¯”è¯çš„èƒ½é‡å¤§çš„é…å¯¹æ•°æ¯”è¯çš„èƒ½é‡æ¯”ç³–çš„èƒ½é‡å¤§çš„ç»„æ•°æ°å¥½å¤š $K$ çš„æ–¹æ¡ˆæ•°.</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>åŸé¢˜æ„å³ç³–çš„èƒ½é‡æ¯”è¯çš„èƒ½é‡å¤§çš„ç»„æ•°æ°å¥½ä¸º $\frac{N+K}{2}$ ç»„çš„æ–¹æ¡ˆæ•°.</p><p>å…ˆæ’ä¸ªåº å†å®¹æ–¥ä¸€ä¸‹å°±å¥½äº† </p><p>$f[i][j]$ è¡¨ç¤ºé€‰æ‹©å‰ $i$ ä¸ªç‰©å“ ç»„æ•°è‡³å°‘ä¸º $j$ çš„æ–¹æ¡ˆ.</p><p>$f[i][j] = \sum f[i-1][j] + f[i-1][j-1] * (k -j+1)$ </p><p>æ³¨æ„æœ€åç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™ é‚£äº›å‰©ä¸‹çš„ $n - i$ æ˜¯å¯ä»¥éšæ„æ’åˆ—çš„è¦ä¹˜ä¸Šé˜¶ä¹˜.</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Keep pluggin',this is your only outlet.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickmul</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> mod)</span></span>&#123;<span class="keyword">return</span> (x*y-(<span class="keyword">int</span>)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mod = <span class="number">1e9</span> + <span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e3</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN],k,n,a[MAXN],b[MAXN],fac[MAXN],inv[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pre</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; ++i) fac[i] = fac[i<span class="number">-1</span>] * i  % Mod;</span><br><span class="line">    inv[MAXN<span class="number">-1</span>] = getinv(fac[MAXN<span class="number">-1</span>],Mod);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = MAXN<span class="number">-2</span>; i &gt;= <span class="number">1</span>; --i) inv[i] = inv[i+<span class="number">1</span>] * (i + <span class="number">1</span>) % Mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m &gt; n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * inv[n - m] % Mod * inv[m] % Mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> y)</span></span>&#123;x = (x + y) % Mod;&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">//freopen("3622.in","r",stdin);</span></span><br><span class="line">    <span class="comment">//freopen("3622.out","w",stdout);</span></span><br><span class="line">    pre();</span><br><span class="line">    <span class="comment">//printf("%lld\n",C(6,2));</span></span><br><span class="line">    n = read(),k  = read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) a[i] = read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) b[i] = read();</span><br><span class="line">    sort(a+<span class="number">1</span>,a+n+<span class="number">1</span>); sort(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>,k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(k &lt; n &amp;&amp; b[k+<span class="number">1</span>] &lt; a[i]) ++k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j) &#123;</span><br><span class="line">            upd(f[i][j],f[i<span class="number">-1</span>][j]);</span><br><span class="line">            upd(f[i][j],f[i<span class="number">-1</span>][j<span class="number">-1</span>] * (max(<span class="number">0L</span>L,k - j + <span class="number">1</span>)) % Mod);</span><br><span class="line">        &#125;</span><br><span class="line">        f[i][<span class="number">0</span>] = f[i<span class="number">-1</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> nk = (n + k) &gt;&gt; <span class="number">1</span>,ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = nk,d = <span class="number">1</span>; i &lt;= n; ++i,d = Mod - d) upd(ans,f[n][i] * d % Mod * C(i,nk) % Mod * fac[n-i] % Mod);<span class="comment">//printf("%lld\n",ans);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;https://www.lydsy.com/JudgeOnline/problem.php?id=3622&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BZOJ3622&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="DP-å®¹æ–¥DP" scheme="http://yoursite.com/categories/DP-%E5%AE%B9%E6%96%A5DP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒBZOJ3065ã€ å¸¦æ’å…¥åŒºé—´Kå°å€¼ æ›¿ç½ªç¾Šæ ‘å¥—ä¸»å¸­æ ‘</title>
    <link href="http://yoursite.com/2018/09/22/%E3%80%8CBZOJ3065%E3%80%8D-%E5%B8%A6%E6%8F%92%E5%85%A5%E5%8C%BA%E9%97%B4K%E5%B0%8F%E5%80%BC-%E6%9B%BF%E7%BD%AA%E7%BE%8A%E6%A0%91%E5%A5%97%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    <id>http://yoursite.com/2018/09/22/ã€ŒBZOJ3065ã€-å¸¦æ’å…¥åŒºé—´Kå°å€¼-æ›¿ç½ªç¾Šæ ‘å¥—ä¸»å¸­æ ‘/</id>
    <published>2018-09-22T04:17:03.000Z</published>
    <updated>2018-09-22T04:31:30.502Z</updated>
    
    <content type="html"><![CDATA[<p>çœŸ-æ¯’ç˜¤é¢˜</p><p>Links there:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3065" target="_blank" rel="noopener">BZOJ3065</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>å¦‚é¢˜,å¼ºåˆ¶åœ¨çº¿,å¸¦ä¿®æ”¹,å¸¦æ’å…¥çš„åŒºé—´ $kâ€‹$ å°å€¼çš„æŸ¥è¯¢</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>ä¸å¸¦æ’å…¥æ˜¯å¯ä»¥å¸¦ä¿®ä¸»å¸­æ ‘ç›´æ¥åšçš„ ä¸å¸¦æ’å…¥çš„å³è½¬ <a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3065" target="_blank" rel="noopener">BZOJ1901</a></p><p>è¿™ä¸ªæ’å…¥çš„æ“ä½œååˆ†çš„ä»¤äººæ¶å¿ƒ æˆ‘ä»¬è¦å¤šç»´æŠ¤ä¸€ä¸ªåŒºé—´é¡ºåºçš„ä¿¡æ¯äº†</p><p>è„‘æµ·é‡Œå›é¡¾ä¸€ä¸‹å­¦è¿‡çš„æ¯’ç˜¤çš„æ•°æ®ç»“æ„ ä¼¼ä¹åªæœ‰å¹³è¡¡æ ‘èƒ½æè¿™ä¸ªä¸œè¥¿äº†</p><p>æ‰€ä»¥æˆ‘ä»¬ç”¨æ›¿ç½ªç¾Šæ ‘å¥—ä¸»å¸­æ ‘!</p><p>Treap?Splay?æ’å…¥çš„æ—¶å€™è¦rotateå¤ªéš¾å†™!</p><p>æˆ‘ä»¬ç”¨æš´åŠ›é‡æ„çš„Scapegoat!</p><p><del>ä¸ç”¨æ—‹è½¬ æ€ç»´æ¯”è¾ƒç®€å• å®ç°éš¾åº¦ä½ ä»£ç é‡å° ç»å¯¹æ˜¯éå¯æŒä¹…åŒ–å¹³è¡¡æ ‘çš„é¦–é€‰å•Š</del></p><p>æ¯æ¬¡æš´åŠ›é‡æ„çš„æ—¶é—´æ˜¯ $O(nlog^2n)$ æ¯ä¸ªç‚¹æœŸæœ›é‡æ„æ¬¡æ•°æ˜¯ä¸¥æ ¼å°äº $logn$ æ¬¡çš„æ‰€ä»¥æ€»å¤æ‚åº¦å°äºç­‰äº $O(nlog^3n)$</p><p>å†è€ƒè™‘ä¸€ä¸‹è¯¢é—® è¿™é‡Œæ˜¯è¦æŠŠæ¯ä¸ªç»“ç‚¹å¯¹åº”åŒºé—´çš„èŠ‚ç‚¹ä½œä¸ºä¸€ä¸ªå‘é‡æ‹‰å‡ºæ¥ å¯¹äºå‘é‡è·‘äºŒåˆ†.</p><p>äºŒåˆ†å¤æ‚åº¦ $logn$ æ¯æ¬¡è¯¢é—®å¯»æ‰¾å¤æ‚åº¦ $logn$ æ‰€ä»¥è¯¢é—®çš„å¤æ‚åº¦ä¸º $O(qlog^2n)$ </p><p>è¿˜æœ‰æ²¡æœ‰ä¼˜åŒ–çš„ä½™åœ°å‘¢ ?</p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ å¯¹äº $N$ ä¸ªæƒå€¼åŒºåŸŸç›¸åŒçš„ä¸»å¸­æ ‘åˆå¹¶å¯ä»¥åšåˆ° $O(nlogn)$</p><p>æ¯æ¬¡æš´åŠ›é‡æ„çš„å¤æ‚åº¦å¯ä»¥é€šè¿‡æƒå€¼çº¿æ®µæ ‘çš„åˆå¹¶åšåˆ° $O(nlog^2n)$</p><p>è¿™æ ·æœ€åçš„å¤æ‚åº¦æ˜¯ $O((n+q) \times log^2n)$ çš„ä½†æ˜¯å› ä¸ºæš´åŠ›é‡æ„çš„æ¬¡æ•°å®é™…ä¸Šå¹¶ä¸å¤š å› æ­¤è¿™ä¸ªä¼˜åŒ–å®è´¨ä¸Šä¹Ÿä¸æ˜æ˜¾</p><p>æ³¨æ„åƒåœ¾å›æ”¶! åƒåœ¾å›æ”¶ä¸€å®šä¸è¦å†™æŒ‚! <del>(è¿™å°±æ˜¯æˆ‘è°ƒä¸€ä¸ªä¸Šåˆçš„ç†ç”±)</del></p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//What is broken can be reforged.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span> + <span class="number">100</span>,m =<span class="number">70000</span>,M = <span class="number">1e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> c[N][<span class="number">2</span>],lson[M],rson[M],rt[M],sz[N],pool[N + <span class="number">5</span>],rub = <span class="number">0</span>,q[M],a[M],p[M],headpq;</span><br><span class="line"><span class="keyword">int</span> n,root = <span class="number">0</span>,headp,headq,trtot = <span class="number">0</span>,lastans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">NextChar</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;<span class="keyword">char</span> c = getchar(); <span class="keyword">while</span>(!<span class="built_in">isalpha</span>(c)) c = getchar(); <span class="keyword">return</span> c;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> xs = <span class="number">0.75</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Newnode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!rub) <span class="keyword">return</span> ++trtot;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> pool[rub--];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Recycle</span><span class="params">(<span class="keyword">int</span> &amp;k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rub &gt; N) --rub;</span><br><span class="line">    pool[++rub] = k;</span><br><span class="line">    <span class="keyword">if</span> (c[k][<span class="number">0</span>]) Recycle(c[k][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span> (c[k][<span class="number">1</span>]) Recycle(c[k][<span class="number">1</span>]);</span><br><span class="line">    sz[k] = <span class="number">0</span>; k = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> &amp;u)</span> </span>&#123;</span><br><span class="line">    Recycle(rt[u]);</span><br><span class="line">    <span class="keyword">if</span> (lson[u]) dfs(lson[u]);</span><br><span class="line">    p[++headp] = u;</span><br><span class="line">    <span class="keyword">if</span> (rson[u]) dfs(rson[u]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> &amp;k,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!k) k=Newnode();</span><br><span class="line">    <span class="keyword">if</span> (l==r)&#123; sz[k]+=y; <span class="keyword">return</span>; &#125; <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x&lt;=mid) ins(c[k][<span class="number">0</span>],l,mid,x,y); <span class="keyword">else</span> ins(c[k][<span class="number">1</span>],mid+<span class="number">1</span>,r,x,y);</span><br><span class="line">    sz[k]=sz[c[k][<span class="number">0</span>]]+sz[c[k][<span class="number">1</span>]];</span><br><span class="line">    <span class="keyword">if</span> (!sz[k]) Recycle(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;k,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (l==r)&#123;</span><br><span class="line">        k=p[l]; ins(rt[k],<span class="number">0</span>,m,a[k],<span class="number">1</span>); <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> i,mid=(l+r)&gt;&gt;<span class="number">1</span>; k=p[mid];</span><br><span class="line">    build(lson[k],l,mid<span class="number">-1</span>); build(rson[k],mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span> (i=l; i&lt;=r; i++) ins(rt[k],<span class="number">0</span>,m,a[p[i]],<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span><span class="params">(<span class="keyword">int</span> &amp;k)</span></span>&#123;</span><br><span class="line">    headp=<span class="number">0</span>; dfs(k); build(k,<span class="number">1</span>,headp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;k,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!k)&#123;</span><br><span class="line">        k=++n; ins(rt[k],<span class="number">0</span>,m,y,<span class="number">1</span>);</span><br><span class="line">        a[k]=y; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ins(rt[k],<span class="number">0</span>,m,y,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> tmp=sz[rt[lson[k]]]; <span class="keyword">bool</span> bo;</span><br><span class="line">    <span class="keyword">if</span> (tmp&gt;=x) bo=add(lson[k],x,y);</span><br><span class="line">        <span class="keyword">else</span> bo=add(rson[k],x-tmp<span class="number">-1</span> ,y);</span><br><span class="line">    <span class="keyword">if</span> (sz[rt[k]]*<span class="number">0.75</span>&gt;max(sz[rt[lson[k]]],sz[rt[rson[k]]]))&#123;</span><br><span class="line">        <span class="keyword">if</span> (bo)</span><br><span class="line">            <span class="keyword">if</span> (tmp&gt;=x) rebuild(lson[k]); <span class="keyword">else</span> rebuild(rson[k]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">getid</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="number">1</span> &amp;&amp; r == sz[rt[k]]) &#123;p[++headp] = rt[k]; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    <span class="keyword">int</span> t = sz[rt[lson[k]]] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= t &amp;&amp; r &gt;= t) q[++headq] = a[k];</span><br><span class="line">    <span class="keyword">if</span> (r &lt; t) getid(lson[k],l,r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (l &gt; t) getid(rson[k],l-t,r-t);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (l &lt; t) getid(lson[k],l,t<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span> (r &gt; t) getid(rson[k],<span class="number">1</span>,r-t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> rst)</span></span>&#123;</span><br><span class="line">    headp=<span class="number">0</span>; headq=<span class="number">0</span>; getid(root,x,y);</span><br><span class="line">    rst--; <span class="keyword">int</span> l=<span class="number">0</span>,r=m,mid,i,tmp;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;</span><br><span class="line">        mid=(l+r)&gt;&gt;<span class="number">1</span>; tmp=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i&lt;=headp; i++) tmp+=sz[c[p[i]][<span class="number">0</span>]];</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i&lt;=headq; i++)</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= q[i] &amp;&amp; q[i]&lt;=mid) tmp++;</span><br><span class="line">        <span class="keyword">if</span> (tmp&gt;rst)&#123;</span><br><span class="line">            <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;=headp; i++) p[i]=c[p[i]][<span class="number">0</span>];</span><br><span class="line">            r=mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;=headp; i++) p[i]=c[p[i]][<span class="number">1</span>];</span><br><span class="line">            l=mid+<span class="number">1</span>;rst-=tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Modify</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    ins(rt[k],<span class="number">0</span>,m,y,<span class="number">1</span>); <span class="keyword">int</span> t = sz[rt[lson[k]]] + <span class="number">1</span>,ret;</span><br><span class="line">    <span class="keyword">if</span> (x == t) &#123;ret = a[k]; a[k] = y;&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x &lt; t) ret = Modify(lson[k],x,y);</span><br><span class="line">    <span class="keyword">else</span> ret = Modify(rson[k],x-t,y);</span><br><span class="line">    ins(rt[k],<span class="number">0</span>,m,ret,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n = read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n) a[i] = read(),p[i] = i;</span><br><span class="line">    build(root,<span class="number">1</span>,n);</span><br><span class="line">    <span class="keyword">int</span> op = read();</span><br><span class="line">    <span class="keyword">while</span>(op--) &#123;</span><br><span class="line">        <span class="keyword">char</span> c = NextChar();</span><br><span class="line">        <span class="keyword">int</span> x = read()^lastans,y = read()^lastans;</span><br><span class="line">        <span class="comment">//printf("%lld %lld\n",x,y);</span></span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'I'</span>) &#123;<span class="keyword">if</span> (add(root,x<span class="number">-1</span>,y)) rebuild(root);&#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'Q'</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> z = read()^lastans; lastans = solve(x,y,z); <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,lastans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> Modify(root,x,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;çœŸ-æ¯’ç˜¤é¢˜&lt;/p&gt;
&lt;p&gt;Links there:&lt;a href=&quot;https://www.lydsy.com/JudgeOnline/problem.php?id=3065&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BZOJ3065&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="åµŒå¥—æ•°æ®ç»“æ„" scheme="http://yoursite.com/categories/%E5%B5%8C%E5%A5%97%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒCF739Eã€ Gosha is hunting WQSäºŒåˆ†ä¼˜åŒ–dp</title>
    <link href="http://yoursite.com/2018/09/17/%E3%80%8CCF739E%E3%80%8D-Gosha-is-hunting-WQS%E4%BA%8C%E5%88%86%E4%BC%98%E5%8C%96dp/"/>
    <id>http://yoursite.com/2018/09/17/ã€ŒCF739Eã€-Gosha-is-hunting-WQSäºŒåˆ†ä¼˜åŒ–dp/</id>
    <published>2018-09-17T13:48:45.000Z</published>
    <updated>2018-09-17T14:38:27.437Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="http://codeforces.com/contest/739/problem/E" target="_blank" rel="noopener">CF739E</a></p><a id="more"></a><p>å†™äº†ä¸ª $O(n^3)$çš„æ¦‚ç‡è½¬ç§» $dp$  è¢«åŠé€€äº†ä¸ä¼šä¼˜åŒ– åªèƒ½å»è¡¥å§¿åŠ¿</p><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æœ‰ $N$ ä¸ªæ€ªç‰©,ä½ æœ‰ $a$ ä¸ª $Pokeball$ å’Œ $b$ ä¸ª $Ultraball$.</p><p>ç»™å‡ºæ¯ä¸ªæ€ªç‰©åˆ†åˆ«è¢« $Pokeball$ å’Œè¢« $Ultraball$ æ•è·çš„æ¦‚ç‡ æ±‚æœ€å¤§èƒ½æ•è·ä¸ªæ•°çš„æœŸæœ›.</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>ä¸Šæ¥æŠ±ç€ $codeforces $ è·‘çš„å·¨å¿«çš„å¿ƒæ€å†™äº†ä¸€å‘ $O(n^3)$</p><p>ç”¨ $f(i,j,k)$ è¡¨ç¤º å‰ $i$ ä¸ªæ€ªç‰©ç”¨ $j$ ä¸ª $Pokeball$, $k$ ä¸ª $Ultraball$ çš„æœ€å¤§æœŸæœ›.</p><p>è¿™ä¸ªè½¬ç§»æ˜¾ç„¶,è®¨è®ºä¸€ä¸‹æ¯ä¸ªæ€ªç‰©</p><blockquote><p>ä¸ç”¨çƒ / ç”¨Pokeball / ç”¨Ultraball / éƒ½ç”¨</p></blockquote><p>å¤§æ¦‚å†™å‡ºæ¥è¿™æ ·å­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= a; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>;  k &lt;= b; ++k)&#123;</span><br><span class="line">                <span class="keyword">int</span> lst = (i &amp; <span class="number">1</span>) ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">                upd(f[lst^<span class="number">1</span>][j][k],f[lst][j][k]);</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= <span class="number">1</span>) upd(f[lst^<span class="number">1</span>][j][k],f[lst][j<span class="number">-1</span>][k] + p[i]);</span><br><span class="line">                <span class="keyword">if</span> (k &gt;= <span class="number">1</span>) upd(f[lst^<span class="number">1</span>][j][k],f[lst][j][k<span class="number">-1</span>] + u[i]);</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= <span class="number">1</span> &amp;&amp; k &gt;= <span class="number">1</span>)</span><br><span class="line">                upd(f[lst^<span class="number">1</span>][j][k],f[lst][j<span class="number">-1</span>][k<span class="number">-1</span>] + <span class="number">1.0</span> - (<span class="number">1.0</span> - p[i]) * (<span class="number">1.0</span> - u[i]));</span><br><span class="line">                <span class="keyword">if</span> (i == n) upd(ans,f[lst^<span class="number">1</span>][j][k]);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åä½ å°±å‘ç°ä½  $T$ é£äº†.</p><p><img src="/2018/09/17/ã€ŒCF739Eã€-Gosha-is-hunting-WQSäºŒåˆ†ä¼˜åŒ–dp/1.png" alt="make"></p><p>ç”¨ $WQS$ äºŒåˆ†çš„æ€æƒ³ </p><p>åŸé—®é¢˜æ˜¾ç„¶å¿…é¡»æŠŠ $a,b$ å–å…‰.</p><p>æ‰€ä»¥è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªæœ‰2ä¸ªé™åˆ¶çš„å– $K$ ä¸ªç‰©å“çš„é—®é¢˜</p><p>å›ºå®š $f(i,a,k)$ çš„ $i,a$ çš„æ—¶å€™ , å‘ç° $f(i,a,k)$ æ˜¯å…³äº $k$ çš„å‡¸å‡½æ•°.</p><p>è¿™æ˜¯æ˜¾ç„¶çš„å¯¹äºå›ºå®šçš„ $i$ ,ä½ æ‰”çš„çƒçš„ä¸ªæ•°è¶Šå¤šçš„è¯æ”¶ç›Šè¶Šå·®.</p><p>ç±»ä¼¼çš„ , å›ºå®š $f(i,j,b)$ çš„ $i,b$ çš„æ—¶å€™ , å‘ç° $f(i,j,b)$ æ˜¯å…³äº $j$ çš„å‡¸å‡½æ•°.</p><p>é‚£ä¹ˆä¸å¦‚ç»™æ¯ä¸ªçƒåŠ ä¸¤ä¸ªé™åˆ¶ $cost1 \space cost2$ è¡¨ç¤ºæ¯ä¸ªç±»å‹çš„çƒé¢å¤–çš„ä»£ä»·.</p><p>äºŒåˆ†å¥—äºŒåˆ†,æœ€åæŠŠè¿™ä¸€éƒ¨åˆ†å½±å“è¿˜åŸå°±æ˜¯ç­”æ¡ˆ.</p><p>å› ä¸º $cost1 \space cost2$ çš„èŒƒå›´åœ¨ $[0,1]$ ä¹‹é—´ æ‰€ä»¥äºŒåˆ†çš„æ¬¡æ•°å¾ˆå°‘ (çœ‹ä½  eps)</p><p>å‡ ä¹å°±æ˜¯ $O(n\times x^2)$ ,$x$ ä¸ºäºŒåˆ†å¸¸æ•° å¯å°äº†.</p><p>è·‘çš„è¿˜çœŸæ˜¯å¿«å‘¢.</p><p><img src="/2018/09/17/ã€ŒCF739Eã€-Gosha-is-hunting-WQSäºŒåˆ†ä¼˜åŒ–dp/2.png" alt="make2"></p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Keep pluggin',this is your only outlet.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"Ofast"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"unroll-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC target(<span class="meta-string">"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickmul</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> mod)</span></span>&#123;<span class="keyword">return</span> (x*y-(<span class="keyword">int</span>)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">2010</span>];</span><br><span class="line"><span class="keyword">double</span> p[<span class="number">2010</span>],u[<span class="number">2010</span>],pu[<span class="number">2010</span>];</span><br><span class="line"><span class="keyword">int</span> numa[<span class="number">2010</span>],numb[<span class="number">2010</span>];</span><br><span class="line"><span class="keyword">int</span> a,b,n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">double</span> &amp;x,<span class="keyword">double</span> y)</span> </span>&#123;x = max(x,y);&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-10</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Calc</span><span class="params">(<span class="keyword">double</span> c1,<span class="keyword">double</span> c2)</span></span>&#123;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0.0</span>; numa[<span class="number">0</span>] = numb[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        f[i] = f[i<span class="number">-1</span>] ; numb[i] = numb[i<span class="number">-1</span>]; numa[i] = numa[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">if</span> (f[i<span class="number">-1</span>] + p[i] - c1 &gt; f[i]) &#123;</span><br><span class="line">            f[i] = f[i<span class="number">-1</span>] + p[i] - c1;</span><br><span class="line">            numa[i] = numa[i<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">            numb[i] = numb[i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (f[i<span class="number">-1</span>] + u[i] - c2 &gt; f[i]) &#123;</span><br><span class="line">            f[i] = f[i<span class="number">-1</span>] + u[i] - c2;</span><br><span class="line">            numa[i] = numa[i<span class="number">-1</span>];</span><br><span class="line">            numb[i] = numb[i<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (f[i<span class="number">-1</span>] + pu[i] - (c1 + c2) &gt; f[i]) &#123;</span><br><span class="line">            f[i] = f[i<span class="number">-1</span>] + pu[i] - (c1 + c2);</span><br><span class="line">            numa[i] = numa[i<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">            numb[i] = numb[i<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n = read(),a = read(),b = read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;p[i]);</span><br><span class="line">    rep(i,<span class="number">1</span>,n) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;u[i]);</span><br><span class="line">    rep(i,<span class="number">1</span>,n) pu[i] = <span class="number">1.0</span> - (<span class="number">1.0</span> - p[i]) * (<span class="number">1.0</span> - u[i]);</span><br><span class="line">    <span class="comment">//O(n^3) dp</span></span><br><span class="line">    <span class="comment">// double ans = 1e-10;</span></span><br><span class="line">    <span class="comment">// for (int i = 1; i &lt;= n; ++i) &#123;</span></span><br><span class="line">    <span class="comment">//     for (int j = 0; j &lt;= min(i,a); ++j)</span></span><br><span class="line">    <span class="comment">//         for (int k = 0;  k &lt;= b; ++k)&#123;</span></span><br><span class="line">    <span class="comment">//             int lst = (i &amp; 1) ? 0 : 1;</span></span><br><span class="line">    <span class="comment">//             upd(f[lst^1][j][k],f[lst][j][k]);</span></span><br><span class="line">    <span class="comment">//             if (j &gt;= 1) upd(f[lst^1][j][k],f[lst][j-1][k] + p[i]);</span></span><br><span class="line">    <span class="comment">//             if (k &gt;= 1) upd(f[lst^1][j][k],f[lst][j][k-1] + u[i]);</span></span><br><span class="line">    <span class="comment">//             if (j &gt;= 1 &amp;&amp; k &gt;= 1)</span></span><br><span class="line">    <span class="comment">//             upd(f[lst^1][j][k],f[lst][j-1][k-1] + 1.0 - (1.0 - p[i]) * (1.0 - u[i]));</span></span><br><span class="line">    <span class="comment">//             if (i == n) upd(ans,f[lst^1][j][k]);</span></span><br><span class="line">    <span class="comment">//         &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">double</span> L = <span class="number">0</span>,R = <span class="number">1</span>,L1,R1;</span><br><span class="line">    <span class="keyword">while</span>(R - L &gt; eps) &#123;</span><br><span class="line">        <span class="keyword">double</span> mid1 = (L + R) / <span class="number">2</span>;</span><br><span class="line">        L1 = <span class="number">0</span>,R1 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(R1 - L1 &gt; eps)&#123;</span><br><span class="line">            <span class="keyword">double</span> mid2 = (L1 + R1) / <span class="number">2</span>;</span><br><span class="line">            Calc(mid1,mid2);</span><br><span class="line">            <span class="keyword">if</span> (numb[n] &gt; b) L1 = mid2;</span><br><span class="line">                <span class="keyword">else</span> R1 = mid2;</span><br><span class="line">        &#125;</span><br><span class="line">        Calc(mid1,R1);</span><br><span class="line">        <span class="keyword">if</span> (numa[n] &gt; a) L = mid1;</span><br><span class="line">            <span class="keyword">else</span> R = mid1;</span><br><span class="line">    &#125;</span><br><span class="line">    Calc(R,R1);</span><br><span class="line">    <span class="keyword">double</span> ans = f[n] + a * R + b * R1;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å‘ç°è‡ªå·±ä¸€ä¸‡å¹´æ²¡æ›´blogäº†.ä¹‹å‰çš„é¢˜ä¼šé™†é™†ç»­ç»­è¡¥ä¸Šæ¥å§.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;http://codeforces.com/contest/739/problem/E&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CF739E&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="WQSäºŒåˆ†" scheme="http://yoursite.com/categories/WQS%E4%BA%8C%E5%88%86/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>WQSäºŒåˆ†-å­¦ä¹ ç¬”è®°</title>
    <link href="http://yoursite.com/2018/09/17/WQS%E4%BA%8C%E5%88%86-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/09/17/WQSäºŒåˆ†-å­¦ä¹ ç¬”è®°/</id>
    <published>2018-09-17T13:44:53.000Z</published>
    <updated>2018-09-17T13:47:08.266Z</updated>
    
    <content type="html"><![CDATA[<p>æ¢å‡ ç§ç§°å‘¼:æ–œç‡å‡¸ä¼˜åŒ– å¸¦æƒäºŒåˆ† è¿™å‡ ä¸ªæœ¬è´¨ä¸Šå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢.</p><a id="more"></a><h4 id="è§£å†³é—®é¢˜çš„èŒƒç•´"><a href="#è§£å†³é—®é¢˜çš„èŒƒç•´" class="headerlink" title="è§£å†³é—®é¢˜çš„èŒƒç•´"></a>è§£å†³é—®é¢˜çš„èŒƒç•´</h4><p>ç»™ä¸€ä¸ªé€‰ç‰©å“çš„é™åˆ¶æ¡ä»¶,åœ¨ $N$ ä¸ªç‰©å“é‡Œè¦æ±‚æ°å¥½é€‰ $K$ ä¸ª,è®©ä½ æœ€å¤§åŒ–/æœ€å°åŒ–æƒå€¼.</p><p>ä¸”å½“é€‰æ‹©ç‰©å“çš„æ•°é‡è¶Šå¤šçš„æ—¶å€™æƒå€¼è¶Šå¤§/è¶Šå°.</p><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p>æ™®é€šçš„DPå¯ä»¥åœ¨$O(nk*C)$çš„æ—¶é—´å†…è§£å†³è¿™ä¸ªé—®é¢˜,å…¶ä¸­ $C$ æ˜¯è½¬ç§»çš„å¤æ‚åº¦.</p><p>ä½†æ˜¯è¦æ˜¯ç¢°ä¸Šç‹¬ç•™çš„å‡ºé¢˜äººå‘¢.</p><p>è¿™ä¸ª $K$ çš„é™åˆ¶ååˆ†çš„ä»¤äººå¤´å¤§, ä¸å¦‚ä¸è€ƒè™‘è¿™ä¸ªç©æ„.ä¹Ÿå°±æ˜¯å»æ‰ç‰©å“ä¸ªæ•°é™åˆ¶ $K$ .</p><p>æˆ‘ä»¬ä»¤å–ä¸€ä¸ªç‰©å“çš„é™„åŠ æƒå€¼ä¸º $Cost$</p><p>é‚£ä¹ˆæ ¹æ®è§£å†³é—®é¢˜çš„èŒƒç•´é‡Œé¢çš„æ€§è´¨.</p><p>å‡è®¾æˆ‘ä»¬ $Cost$ è¶Šå¤§ æˆ‘ä»¬é€‰æ‹©çš„ç‰©å“ä¸ªæ•°éšä¹‹å‡å°‘/å¢å¤§, æƒå€¼ä¹Ÿéšä¹‹å‡å°‘/å¢å¤§</p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨è½¬ç§» $DP$ çš„æ—¶å€™å¯ä»¥è€ƒè™‘è®°å½•ä¸‹å–ç‰©å“çš„ä¸ªæ•°</p><p>æ ¹æ®æ˜¯å¦å¤§äº $K$ æ¥è°ƒæ•´æƒå€¼.</p><p>æœ€åæ‹¿ç­”æ¡ˆå‡æ‰ $Cost$ çš„å½±å“å°±æ˜¯ç­”æ¡ˆ.</p><p>è¿™æ ·çš„å¤æ‚åº¦å°† $K$ è¿™ä¸€ç»´ç¼©æˆäº† $logCost$.å¯¹äº $K$ æ¯”è¾ƒå°çš„æ¥è¯´ å¯èƒ½ä¼˜åŒ–æ•ˆæœå¹¶ä¸æ˜æ˜¾.</p><p>ç®—æ˜¯ä¸ªé»‘ç§‘æŠ€å§ ä»Šå¤©ä¹Ÿæ˜¯å¶å°”é‡åˆ°äº†æ‰å­¦äº†å­¦å‘¢</p><h3 id="æ —å­"><a href="#æ —å­" class="headerlink" title="æ —å­"></a>æ —å­</h3><p>è§æ–°çš„postå§.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¢å‡ ç§ç§°å‘¼:æ–œç‡å‡¸ä¼˜åŒ– å¸¦æƒäºŒåˆ† è¿™å‡ ä¸ªæœ¬è´¨ä¸Šå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢.&lt;/p&gt;
    
    </summary>
    
      <category term="WQSäºŒåˆ†" scheme="http://yoursite.com/categories/WQS%E4%BA%8C%E5%88%86/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>FWT-FMTå­é›†å˜æ¢å·ç§¯å­¦ä¹ ç¬”è®°</title>
    <link href="http://yoursite.com/2018/08/16/FWT-FMT%E5%AD%90%E9%9B%86%E5%8F%98%E6%8D%A2%E5%8D%B7%E7%A7%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/08/16/FWT-FMTå­é›†å˜æ¢å·ç§¯å­¦ä¹ ç¬”è®°/</id>
    <published>2018-08-15T16:20:42.000Z</published>
    <updated>2018-08-15T16:31:34.155Z</updated>
    
    <content type="html"><![CDATA[<p>ç»ˆäºè¢«è®ºæ–‡é¢˜åŠé€€ä¹‹åæ¥è¡¥è¿™ä¸ªå‘äº†</p><a id="more"></a><h3 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h3><p>è¢«HAOI2015æŒ‰ä½æˆ–åŠé€€</p><p>æ»šå›å»è¡¥vfkçš„è®ºæ–‡</p><p>so happy</p><p><strong>å‚è§2015å›½å®¶é˜Ÿè®ºæ–‡ã€Šé›†åˆå¹‚çº§æ•°çš„æ€§è´¨ä¸åº”ç”¨åŠå…¶å¿«é€Ÿç®—æ³•ã€‹</strong> </p><h3 id="é›†åˆå¹‚çº§æ•°"><a href="#é›†åˆå¹‚çº§æ•°" class="headerlink" title="é›†åˆå¹‚çº§æ•°"></a>é›†åˆå¹‚çº§æ•°</h3><h4 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h4><p>ä¹‹å‰å¯¹äºæœ‰å…³é›†åˆçš„è®¡æ•°é—®é¢˜ ,ä¸€èˆ¬çš„å¸¸è§„æ€è·¯æ˜¯ç”¨ $f_S$ å»è¡¨ç¤ºæ–¹æ¡ˆæ•°ç„¶åå»é€’æ¨.</p><p>ç„¶è€Œè¿™ä¸ªæ—¶å€™ä½ çœ‹ä¸€çœ¼é¢˜é¢ æ„è¯†åˆ°è‡ªå·± $O(4^n)$ <del>ç”šè‡³è¿æš´åŠ›éƒ½ä¸å¦‚</del> ï¼ˆä¸å¯¹ è¿™å°±æ˜¯æš´åŠ›ï¼‰</p><p>äºæ˜¯æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸œè¥¿æ¥ä¼˜åŒ–é€’æ¨è½¬ç§»</p><p>è¿˜æ˜¯ç”¨æ•°åˆ—çš„ç†è®ºæ¥ç±»æ¯”.ä¹‹å‰å¤šé¡¹å¼çš„ä¸€äº›ç†è®ºæ˜¯ä¸æ˜¯åœ¨é›†åˆä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨å‘¢?</p><p>æˆ‘ä»¬æ›¾ç»å¯¹äºä¸€ä¸ªæ•°åˆ— $f<em>0,f_1â€¦$ ç”¨ä¸€ä¸ªç”Ÿæˆå‡½æ•°æ¥æè¿° å³ $f(x) = \sum</em> { k=0 } ^ { inf } f_k\times x^k$</p><p>å·¦è¾¹æ˜¯ä¸¥æ ¼çš„æ•°åˆ—é€’æ¨ å³è¾¹æ˜¯ä¼˜ç¾çš„å¤šé¡¹å¼ æœ‰æˆå¥—çš„<del>å·¥å…·</del>(æ¿å­)å»è§£å†³.</p><p>ä½†æ˜¯é›†åˆçš„å¤„ç†æ€ä¹ˆåŠ?</p><p>å¼•å…¥é›†åˆå¹‚çº§æ•°çš„æ¦‚å¿µ</p><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><p>ä»¤ $fâ€‹$ æ˜¯å®šä¹‰åŸŸåœ¨é›†åˆ $Uâ€‹$ ä»¥å†…,æ˜ å°„åˆ° $Fâ€‹$ çš„ä¸€ä¸ª<strong>é›†åˆå¹‚çº§æ•° </strong>, å¯¹äºæ¯ä¸€ä¸ªå®šä¹‰åŸŸä¸­çš„ $S,S \in Uâ€‹$,è®¾ $f_Sâ€‹$ ä¸ºè¯¥ $Sâ€‹$ å¸¦å…¥å‡½æ•°ä¸­æ‰€å¾—åˆ°çš„å€¼.</p><p><strong>ç»“è®º</strong>  ç¡®å®šäº†æ¯ä¸€ä¸ª $S$ æ‰€å¯¹åº”çš„ $f_S$ , $f$ ä¹Ÿå¯ä»¥éšä¹‹ç¡®å®šä¸”å”¯ä¸€.</p><p>æˆ‘ä»¬ç”¨ç±»ä¼¼ç”Ÿæˆå‡½æ•°çš„å®šä¹‰æ–¹å¼çš„å¼å­æ¥å®šä¹‰ $f$ . $f = \sum _  {  S \in U  }   f_S \times  x ^  {  S } $</p><p>è¿™é‡Œçš„ $ f_S $ å¹¶éç³»æ•° è€Œæ˜¯ä¸€ä¸ª $U$ çš„å­é›†æ‰€å¯¹åº”çš„ä¸€ä¸ª<strong>ç‚¹å€¼</strong>.</p><p>æˆ‘è¿˜æ˜¯ä¸¾è®ºæ–‡ä¸Šçš„ä¾‹å­å§ã€‚ã€‚ã€‚</p><p>$U={ 1,2 } , f(x) = 5x^{ \varnothing }$$+ 8x^ {  {  1 } }$ $+$ $13x^ {  { 1,2}}$</p><p>åˆ™è¿™ä¸ªé›†åˆå¹‚çº§æ•°é‡Œ,$f({ 1,2 } ) = 13$,$f(\varnothing) = 5,f( { 1}) = 8$</p><p>è€ƒè™‘è¿™ä¸ªç©æ„çš„è¿ç®—.</p><p>åŠ å‡æ³•æ˜¾ç„¶ç³»æ•°ç›¸åŠ ç›¸å‡å³å¯.ä½†æ˜¯ä¹˜æ³•å‘¢ï¼Ÿæˆ‘ä»¬å¯¹äºé›†åˆçš„è¿ç®—å–å¹¶å–äº¤ å¾—åˆ°çš„ä¼¼ä¹å¹¶ä¸ç›¸åŒå•Š</p><p>å¼•å‡ºå­é›†å˜æ¢é›†åˆå·ç§¯</p><h3 id="FMT-Fast-Mobius-Transform-å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢"><a href="#FMT-Fast-Mobius-Transform-å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢" class="headerlink" title="FMT(Fast Mobius Transform)å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢"></a>FMT(Fast Mobius Transform)å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢</h3><p>å–é›†åˆè¿ç®— $L \subseteq U,R \subseteq U$ï¼Œ$L * R = L \cup R$</p><p>$f(x) = \sum<em> { S \subseteq L} f_S x^S ,g(x) = \sum</em> { S \subseteq R}g_S x^S$</p><p>å®ƒä»¬çš„å·ç§¯ä¸º $h(x) = \sum<em> { L \subseteq U}  \sum</em> { R\subseteq U}f_Lg_R(L \cup R = S)$</p><h4 id="Bruteforce"><a href="#Bruteforce" class="headerlink" title="Bruteforce"></a>Bruteforce</h4><p>æš´åŠ›æšä¸¾é›†åˆ å¤æ‚åº¦ $O(3^N)$ ç¾æ»‹æ»‹</p><h4 id="Divide-amp-Conquer"><a href="#Divide-amp-Conquer" class="headerlink" title="Divide &amp; Conquer"></a>Divide &amp; Conquer</h4><p>è€ƒè™‘åˆ†æ²»ä¹˜ å¯¹äºç°æœ‰çš„é›†åˆ $U = \ { 1,2,3,4,â€¦n}$ è€ƒè™‘ $ n $ å•ç‹¬æå‡ºæ¥ åˆ†ç±».</p><p>ç°åœ¨è®°å· $F_1(x)$ è¡¨ç¤ºç°æœ‰çš„é›†åˆä¸­ä¸åŒ…å« $n$ çš„ $F_2(x)$ è¡¨ç¤ºç°æœ‰çš„é›†åˆä¸­åŒ…å« $n$ ä½†æ˜¯è¦é™¤å»çš„</p><p>$f * g = (F_1+ { x_nF_2})(G_1+x_nG_2)$</p><p>ç„¶åå±•å¼€åˆ†æ²»ç®—å°±å¯ä»¥äº†.</p><p>$T(n) = T(n-1)+O(2^N)$ ç”±ä¸»å®šç† $T(n) = O(N\times2^N)$</p><p>æ®ç‚¸é¸¡å°å¼Ÿå£°ç§° åˆ†æ²»ä¹˜å¾€å¾€è·‘çš„æ¯”$FMT$å¿« ä½†ä¹Ÿå¹¶ä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆâ€¦</p><h4 id="Fast-Mobius-Transform"><a href="#Fast-Mobius-Transform" class="headerlink" title="Fast Mobius Transform"></a>Fast Mobius Transform</h4><p>è¯æ˜çœ‹è®ºæ–‡ è¿™é‡Œåªè®²ç»“è®º</p><p>å®šä¹‰ä¸€ä¸ªå¹‚çº§æ•°çš„è«æ¯”ä¹Œæ–¯å˜æ¢ä¸º</p><p>$F<em>S = \sum</em> { T \subseteq S}f_T$</p><p>åè¿‡æ¥ æˆ‘ä»¬å®šä¹‰ $F$ çš„è«æ¯”ä¹Œæ–¯åæ¼”ä¸º $f$</p><p>æ¨ä¸ªå®¹æ–¥é”™ä½ç›¸å‡ $f<em>S = \sum</em> { T \subseteq S} { (-1)^ { |S-T|}F_T}$</p><p>æˆ‘ä»¬ç®—å·ç§¯çš„æ—¶å€™ $h(x) = \sum<em> { L \subseteq U}  \sum</em> { R\subseteq U}f_Lg_R(L \cup R = S)$</p><p>ä¸¤è¾¹åŒæ—¶åæ¼”.æœ€åå¯ä»¥å¾—åˆ° $H = F * G$ å³ åæ¼”åä¾ç„¶æˆç«‹</p><p>æœ€åä¸¤è¾¹åæ¼”å³å¯ . è¿™æ ·æˆ‘ä»¬ç®—å‘ $ f,g$ çš„å·ç§¯ åªè¦å…ˆè«æ¯”ä¹Œæ–¯å˜æ¢ ç„¶åç›¸ä¹˜ä¹‹å å†è«æ¯”ä¹Œæ–¯åæ¼” å°±å¯ä»¥å•¦</p><p>å¤æ‚åº¦$O(N \times 2^N)$</p><h4 id="æ¨¡æ¿-StupidOJ47"><a href="#æ¨¡æ¿-StupidOJ47" class="headerlink" title="æ¨¡æ¿ StupidOJ47"></a>æ¨¡æ¿ StupidOJ47</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,b) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n) &#123; <span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch)) &#123; f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) &#123; x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e6</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[MAXN],b[MAXN],l = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fmt</span><span class="params">(<span class="keyword">int</span> a[],<span class="keyword">int</span> len,<span class="keyword">int</span> type)</span> </span>&#123;  <span class="comment">//type = -1 åæ¼”</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; len) - <span class="number">1</span>; ++j)</span><br><span class="line">        a[j] += type * a[(<span class="number">1</span>&lt;&lt;i)^j] * (j &gt;&gt; i &amp; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123; </span><br><span class="line">    n = read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i = i &lt;&lt; <span class="number">1</span>, ++l);</span><br><span class="line">    rep(i,<span class="number">0</span>,n<span class="number">-1</span>) a[i] = read();</span><br><span class="line">    rep(i,<span class="number">0</span>,n<span class="number">-1</span>) b[i] = read();</span><br><span class="line">    fmt(a,l,<span class="number">1</span>); fmt(b,l,<span class="number">1</span>);</span><br><span class="line">    rep(i,<span class="number">0</span>,n<span class="number">-1</span>) a[i] = a[i] * b[i];</span><br><span class="line">    fmt(a,l,<span class="number">-1</span>);</span><br><span class="line">    rep(i,<span class="number">0</span>,n<span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"%lld "</span>,a[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="Fast-Walsh-Hadamard-Transform"><a href="#Fast-Walsh-Hadamard-Transform" class="headerlink" title="Fast Walsh-Hadamard Transform"></a>Fast Walsh-Hadamard Transform</h3><p>æœ¬è´¨ä¸Šå°±æ˜¯æ¯ä¸€ä½åªå¯èƒ½æ˜¯ $1,0$ çš„å¤šé¡¹å¼</p><p>æ‡’å¾—è¯æ˜æ­£ç¡®æ€§äº† ä½†æ˜¯è¿™æ˜¯ç¡®å®å­˜åœ¨çš„</p><p>$FWT(A+B) = FWT(A) +FWT(B)$</p><p>$FWT(A \oplus  B) = FWT(A) \times FWT(B)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt_and</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> type)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p = (i &gt;&gt; <span class="number">1</span>) , j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt; j + p; ++k)</span><br><span class="line">            a[k+p] += a[k] * type;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt_or</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> type)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p = (i &gt;&gt; <span class="number">1</span>), j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt; j + p; ++k)</span><br><span class="line">            a[k] += a[k+p] * type;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt_xor</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> type)</span> </span>&#123;  <span class="comment">//modæ„ä¹‰ä¸‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p = (i &gt;&gt; <span class="number">1</span>), j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt; j + p; ++k) &#123; </span><br><span class="line">                <span class="keyword">int</span> x = (a[k] + a[k+p]),y = (a[k]-a[k+p]);</span><br><span class="line">                a[k] = x; a[k+p] = y;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">int</span> inv = getinv(quickpow(<span class="number">2</span>,n,Mod),Mod);</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="number">-1</span>) <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) a[i] = a[i] * inv % Mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»ˆäºè¢«è®ºæ–‡é¢˜åŠé€€ä¹‹åæ¥è¡¥è¿™ä¸ªå‘äº†&lt;/p&gt;
    
    </summary>
    
      <category term="FWT,FMT" scheme="http://yoursite.com/categories/FWT-FMT/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€Œhihocoder1596ã€Beautiful Sequences</title>
    <link href="http://yoursite.com/2018/08/16/%E3%80%8Chihocoder1596%E3%80%8DBeautiful-Sequences/"/>
    <id>http://yoursite.com/2018/08/16/ã€Œhihocoder1596ã€Beautiful-Sequences/</id>
    <published>2018-08-15T16:20:32.000Z</published>
    <updated>2018-08-16T16:03:03.500Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="https://hihocoder.com/problemset/problem/1596" target="_blank" rel="noopener">hihocoder-1596</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>å¯¹äºä¸€ä¸ªæ­£æ•´æ•°åˆ— $ a[1], â€¦ , a[n] (n â‰¥ 3) $ï¼Œå¦‚æœå¯¹äºæ‰€æœ‰ $2 â‰¤ i â‰¤ n - 1$ ï¼Œéƒ½æœ‰ $a[i-1] + a[i+1] â‰¥ 2 Ã— a[i]$ ï¼Œåˆ™ç§°è¿™ä¸ªæ•°åˆ—æ˜¯ç¾ä¸½çš„ã€‚</p><p>ç°åœ¨æœ‰ä¸€ä¸ªæ­£æ•´æ•°åˆ— $b[1], â€¦, b[n]$ ï¼Œè¯·è®¡ç®—:å°† $b$ æ•°åˆ—å‡åŒ€éšæœºæ‰“ä¹±ä¹‹åï¼Œå¾—åˆ°çš„æ•°åˆ—æ˜¯ç¾ä¸½çš„æ¦‚ç‡ $P$ã€‚</p><p>ä½ åªéœ€è¦è¾“å‡º $(P Ã— (n!)) $ $ mod \space 1000000007$ å³å¯ã€‚ï¼ˆæ˜¾ç„¶ $P Ã— (n!)$ ä¸€å®šæ˜¯ä¸ªæ•´æ•°ï¼‰</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å°†${ a_i}$è½¬åŒ–ä¸ºç»´æŠ¤ä¸€ä¸ªå‡¸å‡½æ•°çš„å›¾åƒ ç”¨$f[i][j][k][t]$ è¡¨ç¤ºå½“å‰ç¬¬ $i$ ä¸ª,å·¦ç«¯ç‚¹æœ€å¤§å€¼å’Œæ¬¡å¤§å€¼ä¸º $a[i],a[j]$ ,å³ç«¯ç‚¹æœ€å¤§å€¼ä¸º $a[k]$ , æ¬¡å¤§å€¼ $a[t]$ çš„æ–¹æ¡ˆ.ç”±äºå·²ç»æ’è¿‡åº,æ–°åŠ è¿›æ¥çš„ $å¥‘$ ä¸€å®šæ¯”å½“å‰å·¦å³ç«¯ç‚¹çš„éƒ½è¦å¤§.</p><p>é‚£ä¹ˆæœ‰ä¸¤ç§æƒ…å†µ,è¦ä¹ˆåœ¨å·¦è¾¹æˆç«‹ è¦ä¹ˆåœ¨å³è¾¹æˆç«‹.</p><script type="math/tex; mode=display">f[i][j][k][t] =>f[i+1][i][k][t] \space (a[i+1] + a[j]\geq 2 \times a[i]) \\\\f[i][j][k][t] =>f[i][j][i+1][k] \space (a[i+1] + a[t]  \geq 2 \times a[k])</script><p>è¿™ç¬¬äºŒä¸ªæŸ¿å­æœ‰ä¸€ç‚¹å¥‡æ€ª ä½†æ˜¯å› ä¸ºå·¦è¾¹ç«¯ç‚¹å…¶å®æ˜¯å’Œå³è¾¹ç«¯ç‚¹ç­‰ä»·çš„. æ‰€ä»¥å¯ä»¥å°†ä¸Šé¢ç¬¬äºŒä¸ªå†™æˆè¿™æ ·</p><script type="math/tex; mode=display">f[i][j][k][t] =>f[i+1][k][i][j] \space (a[i+1] + a[t]  \geq 2 \times a[k])</script><p>æ³¨æ„ç»†èŠ‚å°†æ‰€æœ‰æœ€å°çš„è®¡æ•° ç„¶åç­”æ¡ˆå»ä¹˜å®ƒçš„é˜¶ä¹˜.</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,b) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,b[<span class="number">61</span>],f[<span class="number">61</span>][<span class="number">61</span>][<span class="number">61</span>][<span class="number">61</span>],ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isok</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">2</span>*b[x] &lt;= b[a] + b[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> y)</span></span>&#123;x=(x+y)%Mod;&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// freopen("data.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("data.ans","w",stdout);</span></span><br><span class="line">    n=read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n) b[i]=read();</span><br><span class="line">    sort(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> ll = b[<span class="number">1</span>],l = <span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,n) &#123;<span class="keyword">if</span> (ll == b[i]) ++l,ans = ans * i % Mod;&#125;</span><br><span class="line">    <span class="keyword">if</span> (l == n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    f[l][l][l][l] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= n - <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= i; ++k)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">1</span>; t &lt;= i; ++t) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!f[i][j][k][t]) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">int</span> del = f[i][j][k][t];</span><br><span class="line">                    upd(f[i+<span class="number">1</span>][i][k][t],del * isok(i+<span class="number">1</span>,i,j));</span><br><span class="line">                    upd(f[i+<span class="number">1</span>][k][i][j],del * isok(i+<span class="number">1</span>,k,t));</span><br><span class="line">                &#125;</span><br><span class="line">    <span class="keyword">int</span> ans2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; ++k)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">1</span>; t &lt;= n; ++t)</span><br><span class="line">            upd(ans2,f[n][j][k][t]);</span><br><span class="line">    ans2 = ans2 * ans % Mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;https://hihocoder.com/problemset/problem/1596&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;hihocoder-1596&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="DP-æœŸæœ›DP" scheme="http://yoursite.com/categories/DP-%E6%9C%9F%E6%9C%9BDP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒHDU5823ã€2016å¤šæ ¡è”åˆRound8 Color II çŠ¶å‹</title>
    <link href="http://yoursite.com/2018/08/16/%E3%80%8CHDU5823%E3%80%8D2016%E5%A4%9A%E6%A0%A1%E8%81%94%E5%90%88Round8-Color-II-%E7%8A%B6%E5%8E%8B/"/>
    <id>http://yoursite.com/2018/08/16/ã€ŒHDU5823ã€2016å¤šæ ¡è”åˆRound8-Color-II-çŠ¶å‹/</id>
    <published>2018-08-15T16:20:09.000Z</published>
    <updated>2018-08-16T16:03:16.391Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="http://acm.hdu.edu.cn/showproblem.php?pid=5823" target="_blank" rel="noopener">HDU5823</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æ±‚ä¸€ä¸ªå›¾çš„æ¯ä¸€ä¸ªå­å›¾çš„æœ€å°æŸ“è‰²æ•°.</p><p>ç‚¹é›†å¤§å° $N \leq 18$ </p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>æš´åŠ›æšä¸¾å­é›†çš„å¤æ‚åº¦æ˜¯ $O(3^n)$ ,ç­‰ç­‰! ä¼¼ä¹ $3^{18} = 387420489$ å¯èƒ½å¸¸æ•°ä¼˜ç§€å¯ä»¥è¿‡ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæšä¸¾å­å›¾ å†æšä¸¾å­é›† æ˜¯ç‹¬ç«‹é›†åˆ æ¶‚ä¸€ä¸ªé¢œè‰²</p><p>ç„¶åå°†è¿™ä¸ªå­é›†å‰©ä¸‹çš„çŠ¶æ€è½¬ç§»å‡ºæ¥ $f[S] = min(f[S],f[Sè¡¥]+1)$</p><p>äº¤äº†ä¸€å‘ å±…ç„¶è¿‡äº†!</p><p>å…¶å®åˆ©ç”¨å¿«é€Ÿæ²ƒå°”ä»€å˜åŒ–å¯ä»¥ä¼˜åŒ–åˆ° $O(2^N \times N^2)$ </p><p>å…·ä½“å¯ä»¥çœ‹è¿™é‡Œ<a href="https://blog.csdn.net/v5zsq/article/details/52403255" target="_blank" rel="noopener">Link</a></p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,b) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int unsigned</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> msk,t,n;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">19</span>][<span class="number">19</span>];</span><br><span class="line"><span class="keyword">int</span> res[<span class="number">1</span>&lt;&lt;<span class="number">18</span>],valid[<span class="number">1</span>&lt;&lt;<span class="number">18</span>];</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    t=read();</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        n=read();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,s[i]+<span class="number">1</span>);</span><br><span class="line">        MM(valid,<span class="number">1</span>); MM(res,<span class="number">0x3F</span>);</span><br><span class="line">        msk = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= msk; ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (i&gt;&gt;(j<span class="number">-1</span>)&amp;<span class="number">1</span>)</span><br><span class="line">                 <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; ++k)</span><br><span class="line">                <span class="keyword">if</span> ((i&gt;&gt;(k<span class="number">-1</span>)&amp;<span class="number">1</span>) &amp;&amp; s[j][k] == <span class="string">'1'</span>) &#123;valid[i] = <span class="number">0</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">                <span class="keyword">if</span> (!valid[i]) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= msk; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> S = i; S; S = (S<span class="number">-1</span>)&amp;i)</span><br><span class="line">            <span class="keyword">if</span> (valid[S]) res[i] = min(res[i],res[S^i] + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> mul = <span class="number">1</span>,ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= msk; ++i) mul = mul * <span class="number">233</span>, ans += res[i] * mul;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%u\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=5823&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;HDU5823&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="DP-çŠ¶å‹DP" scheme="http://yoursite.com/categories/DP-%E7%8A%B6%E5%8E%8BDP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒCTSC2018ã€å‡é¢(faceless) æ¦‚ç‡ä¸æœŸæœ›dp é€’æ¨ 01èƒŒåŒ…è¿˜åŸ </title>
    <link href="http://yoursite.com/2018/08/16/%E3%80%8CCTSC2018%E3%80%8D%E5%81%87%E9%9D%A2-faceless-%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9Bdp-%E9%80%92%E6%8E%A8-01%E8%83%8C%E5%8C%85%E8%BF%98%E5%8E%9F/"/>
    <id>http://yoursite.com/2018/08/16/ã€ŒCTSC2018ã€å‡é¢-faceless-æ¦‚ç‡ä¸æœŸæœ›dp-é€’æ¨-01èƒŒåŒ…è¿˜åŸ/</id>
    <published>2018-08-15T16:19:44.000Z</published>
    <updated>2018-08-16T16:02:56.653Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="https://loj.ac/problem/2552" target="_blank" rel="noopener">CTSC2018å‡é¢</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æœ‰ $N$ ä¸ªæ•Œäºº,æ¯ä¸ªæ•Œäººçš„è¡€æ¡ä¸º $hp_i$ ,é’ˆé’ˆä¼šä¸¢ $Q$ ä¸ªæŠ€èƒ½.</p><p>æŠ€èƒ½1:æŒ‡å®šä¸€ä¸ªæ•Œæ–¹å•ä½ $id$ ,ç»™å‡º $u,v$ ,è¡¨ç¤ºæœ‰ $\frac{u}{v}$ çš„æ¦‚ç‡å‘½ä¸­è¿™ä¸ªå•ä½å¹¶é€ æˆ1çš„ä¼¤å®³.</p><p>æŠ€èƒ½2:ç»™å‡ºä¸€ä¸ªæ•Œäººçš„é›†åˆ ${ id_i }$ ,å¤§å°ä¸º $k$ ,æ±‚æ¯ä¸€ä¸ª $id_i$ çš„å­˜æ´»æœŸæœ›.</p><p>æœ€åè¿˜è¦æ±‚å‡ºæ¯ä¸ªæ•Œäººçš„è¡€é‡å‰©ä½™çš„æœŸæœ›.</p><p>(è¯­æ–‡æ°´å¹³ä½ä¸‹è¿˜æ³è¯·çœ‹åŸé¢˜é¢)</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è€ƒè™‘ç”¨ $a[i][j]$ è¡¨ç¤ºç¬¬ $i$ ä¸ªæ•Œäººå‰©ä¸‹ $j$ çš„è¡€é‡çš„æœŸæœ›.</p><p>æˆ‘ä»¬å¯¹äºæ¯ä¸€æ¬¡æŠ€èƒ½ $1$ æ˜¯å¯ä»¥åœ¨ $O(hp[id])$ å†…ç»´æŠ¤å‡ºè¿™ä¸ª $a[id][j]$ çš„,ä¸éš¾ç†è§£.</p><p>å…·ä½“å¦‚ä¸‹</p><p>$a[id][0] = a[id][0] + a[id][1] * p$ (å·²ç»æŒ‚äº†åŠ ä¸Šåªå‰©ä¸‹1æ»´è¡€çš„è¿™æ¬¡æŒ‚æ‰çš„)</p><p>$a[id][i] = (a[id][i] <em> (1-p) + a[id][i+1] </em> p)$ (æ‰“å¾—åˆ°ä¸æ‰“ä¸åˆ°)</p><p>ç”¨ $f[i][j]$ è¡¨ç¤ºå‰ $i$ ä¸ªæ•Œäººæœ‰ $j$ ä¸ªå­˜æ´»çš„æœŸæœ›.</p><p>ç”¨ $exist[i]$ è¡¨ç¤ºæŠ€èƒ½2ä¸­é›†åˆç¬¬ $i$ ä¸ªçš„å­˜æ´»æœŸæœ›</p><p>ç”¨ $dead[i]$ è¡¨ç¤ºæŠ€èƒ½2ä¸­é›†åˆç¬¬ $i$ ä¸ªçš„æ­»äº¡æœŸæœ›</p><p>é‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ªæŠ€èƒ½ $2$ æœ¬è´¨ä¸Šæ˜¯ä¸€æ¬¡è¯¢é—®æ“ä½œ.</p><p>é€šè¿‡è€ƒè™‘ç¬¬ $i$ ä¸ªæ•Œäººçš„å­˜æ´»ä¸å¦ ä¸éš¾æœ‰ä»¥ä¸‹çš„è½¬ç§»</p><script type="math/tex; mode=display">f[i][0] = f[i-1][0] * dead[i]\\\\f[i][j] = (f[i-1][j-1] * exist[i] + f[i-1][j] * dead[i])</script><p>è¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥å¯¹äºæ¯ä¸€ä¸ªé›†åˆä¸­çš„å…ƒç´  éƒ½è¿™ä¹ˆæš´åŠ›è·‘ä¸€éå°±å¯ä»¥å¾—åˆ°æ¯ä¸ªçš„æœŸæœ›.</p><p>æ—¶é—´å¤æ‚åº¦ä¸º $O(Cn^3 + Qm)$ , $m$ ä¸ºæœ€å¤§$hp$å€¼.</p><p>åªæ‹¿åˆ° $70pts$</p><p>è€ƒè™‘ä¼˜åŒ– æ¯ä¸€æ¬¡æˆ‘ä»¬éƒ½æš´åŠ›é‡æ–°è½¬ç§» æ˜¾ç„¶å¾ˆå¤šçŠ¶æ€éƒ½è¢«æµªè´¹äº†</p><p>è€ƒè™‘é€†è½¬ç§» </p><script type="math/tex; mode=display">f[i][j] = (f[i-1][j-1] * exist[i] + f[i-1][j] * dead[i])</script><p>ä»¤$f[i][j] = fâ€™[j]$ è¡¨ç¤ºè¦è½¬ç§»åˆ°çš„çŠ¶æ€. $fâ€™[j]$ ç”± $f[j-1],f[j]$ è½¬ç§»è€Œæ¥</p><script type="math/tex; mode=display">f'[j] = (f[j-1] * exist[i] + f[j] * dead[i])</script><p>æŠŠå®ƒæ”¹å†™è¿‡æ¥å°±æ˜¯</p><script type="math/tex; mode=display">f[j] = \frac{f'[j] - f[j-1]*exist[i]}{dead[i]}</script><p>è¿™æ ·æ¯æ¬¡æˆ‘ä»¬å°±å¯ä»¥ä¸éœ€è¦æš´åŠ›é‡ç½®çŠ¶æ€å•¦ï¼è¿™æ ·å°±å¯ä»¥ä¼˜åŒ–æˆ$O(Cn^2+Qm)$</p><p><strong>å‘ç‚¹</strong> æ³¨æ„æ±‚é€†å…ƒä¸è¦æ¯æ¬¡éƒ½åœ¨åšçš„æ—¶å€™<code>getinv(x,Mod)</code>è¿™æ ·å¤æ‚åº¦å¤šäº†ä¸€ä¸ª<code>log(Mod)</code></p><p>è™½ç„¶è¿‡äº†é¢˜ä½†æ˜¯è¿˜æ˜¯è¦å°å¿ƒå•Š é¢„å¤„ç†çº¿æ¨é€†å…ƒ.</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,b) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">210</span>;</span><br><span class="line"><span class="keyword">int</span> n,hp[MAXN],f[MAXN][MAXN],g[MAXN],t[MAXN],Inv[MAXN],</span><br><span class="line">    inv[MAXN],m,exist[MAXN],a[MAXN][MAXN],dead[MAXN],</span><br><span class="line">    ans[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    Inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">200</span>; ++i) Inv[i] = (Mod - Mod/i) * (Inv[Mod % i]) % Mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) hp[i] = read(),a[i][hp[i]] = <span class="number">1</span>;</span><br><span class="line">    m=read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> op = <span class="number">1</span>; op &lt;= m; ++op)&#123;</span><br><span class="line">        <span class="keyword">int</span> opt = read();</span><br><span class="line">        <span class="keyword">if</span> (opt) &#123;</span><br><span class="line">            <span class="keyword">int</span> k = read();</span><br><span class="line">            rep(i,<span class="number">1</span>,k) t[i] = read();</span><br><span class="line">            rep(i,<span class="number">1</span>,k) exist[i] = (<span class="number">1</span>-a[t[i]][<span class="number">0</span>]+Mod) % Mod;</span><br><span class="line">            rep(i,<span class="number">1</span>,k) dead[i] = (<span class="number">1</span>-exist[i]+Mod) % Mod;</span><br><span class="line">            f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            rep(i,<span class="number">1</span>,n)</span><br><span class="line">            &#123;</span><br><span class="line">                f[i][<span class="number">0</span>] = f[i<span class="number">-1</span>][<span class="number">0</span>] * dead[i] % Mod;</span><br><span class="line">                rep(j,<span class="number">1</span>,i)</span><br><span class="line">                f[i][j] = (f[i<span class="number">-1</span>][j<span class="number">-1</span>] * exist[i] % Mod + f[i<span class="number">-1</span>][j] * dead[i] % Mod) % Mod;</span><br><span class="line">            &#125;</span><br><span class="line">            rep(i,<span class="number">1</span>,k) ans[i] = <span class="number">0</span>;</span><br><span class="line">            rep(i,<span class="number">1</span>,k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (exist[i]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (exist[i] == <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j)</span><br><span class="line">                        g[j<span class="number">-1</span>] = f[k][j];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">int</span> ded = getinv(dead[i],Mod);</span><br><span class="line">                        g[<span class="number">0</span>] = f[k][<span class="number">0</span>] * ded % Mod;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j)</span><br><span class="line">                        g[j] = (f[k][j] - exist[i] * g[j<span class="number">-1</span>] % Mod + Mod) * ded % Mod;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j)</span><br><span class="line">                    ans[i] = (ans[i] + exist[i] * g[j<span class="number">-1</span>] % Mod * Inv[j] % Mod) % Mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>,ans[i]);</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> id = read(),u = read(),v = read(),p = u * getinv(v,Mod) % Mod;</span><br><span class="line">            a[id][<span class="number">0</span>] = (a[id][<span class="number">0</span>] + a[id][<span class="number">1</span>] * p % Mod) % Mod;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= hp[id]; ++i)</span><br><span class="line">            a[id][i] = (a[id][i] * (<span class="number">1</span>-p+Mod) % Mod + a[id][i+<span class="number">1</span>] * p % Mod) % Mod;</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) ans[i] = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= hp[i]; ++j)</span><br><span class="line">         ans[i] = (ans[i] + a[i][j] * j % Mod) % Mod;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>,ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">0 2 1 1</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">0 2 1 1</span></span><br><span class="line"><span class="comment">0 3 1 1</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 3 1 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">499122177 0 499122177</span></span><br><span class="line"><span class="comment">1 0 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;https://loj.ac/problem/2552&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CTSC2018å‡é¢&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="DP-æœŸæœ›DP" scheme="http://yoursite.com/categories/DP-%E6%9C%9F%E6%9C%9BDP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>Suffix Automaton åç¼€è‡ªåŠ¨æœºå­¦ä¹ ç¬”è®°</title>
    <link href="http://yoursite.com/2018/08/09/Suffix-Automaton-%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/08/09/Suffix-Automaton-åç¼€è‡ªåŠ¨æœºå­¦ä¹ ç¬”è®°/</id>
    <published>2018-08-08T22:29:41.000Z</published>
    <updated>2018-08-08T22:32:56.998Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åç¼€è‡ªåŠ¨æœº-Suffix-Automaton-SAM"><a href="#åç¼€è‡ªåŠ¨æœº-Suffix-Automaton-SAM" class="headerlink" title="åç¼€è‡ªåŠ¨æœº Suffix Automaton (SAM)"></a>åç¼€è‡ªåŠ¨æœº Suffix Automaton (SAM)</h2><a id="more"></a><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><p>åç¼€è‡ªåŠ¨æœºï¼Œæœ¬è´¨ä¸Šæ˜¯å…³äºå•è¯çš„æœ‰å‘æ— ç¯å›¾ï¼Œæ˜¯ä¸€ç§å¼ºæœ‰åŠ›çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥åœ¨$O(n)$çš„æ—¶é—´å†…æ„é€ å®Œæˆå¹¶è¾…åŠ©è§£å†³å¾ˆå¤šå­—ç¬¦ä¸²é—®é¢˜ã€‚å®ƒä¹Ÿå¯ä»¥è¢«ç†è§£ä¸ºä¸€ä¸ªé•¿åº¦ä¸º$N$çš„å­—ç¬¦ä¸²çš„å‹ç¼©ä¹‹åå­˜èµ·æ¥çš„ä¿¡æ¯ã€‚</p><p>åç¼€è‡ªåŠ¨æœºæ˜¯é™ˆè€å¸ˆ<code>WJMZBMR</code>é¦–æ¬¡å¼•è¿›å›½å†…OIåœˆçš„ï¼Œé™ˆè€å¸ˆçš„è®ºæ–‡å…¨æ˜¯å¹²è´§ã€‚</p><h3 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><h4 id="ä¸€äº›è¯´æ˜"><a href="#ä¸€äº›è¯´æ˜" class="headerlink" title="ä¸€äº›è¯´æ˜"></a>ä¸€äº›è¯´æ˜</h4><p>$Status(str)$è¡¨ç¤º$trans(init,str)$</p><p>$Reg(s)$è¡¨ç¤ºä»çŠ¶æ€$s$å¼€å§‹å¯ä»¥è¯†åˆ«çš„$string$(åç¼€é›†åˆ)</p><p>ä¸‹é¢è¿™ä¸€æ®µæ˜¯å…³äº$Reg(s)$çš„è§£é‡Š</p><p>ä»€ä¹ˆæ˜¯$Reg(s)$? <strong>å¥½é—®é¢˜</strong>!ä¸¾ä¸ªä¾‹å­:</p><p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªä¸²$S = â€œABCABCBDâ€$</p><p>å¯¹äºè¦åœ¨$S$ä¸­å¯»æ‰¾çš„ä¸€ä¸ªå­ä¸²$Sâ€™ = â€œBCâ€$</p><p>å¾ˆæ˜æ˜¾å‡ºç°ä½ç½®çš„é›†åˆä¸º${ (2,3),(5,6)}$</p><p>ä»–å‡ºç°çš„åç¼€é›†åˆä¸º${ suffix(3), suffix(6)}$</p><p>å¯¹äºä¸€ä¸ª$string \space a$</p><script type="math/tex; mode=display">Reg(Status(a)) = \{ suffix(r_1),suffix(r_2) ... suffix(r_n)\}</script><p>å¾ˆæ˜æ˜¾ æˆ‘ä»¬åªè¦å­˜ä¸‹äº†${r1,r2,â€¦,rn}$ å°±å¯ä»¥ç¡®å®šè¿™ä¸ª$Reg(Status(a))$</p><p>ä¸å¦¨ç”¨ä¸€ä¸ªé›†åˆ$Right(a)$æ¥è®°å½•è¿™ä¸€ä¿¡æ¯</p><p><strong>æ€§è´¨1</strong> å¯¹äºä¸¤ä¸ªå­ä¸²$a,b$,å¦‚æœ$Right(a) = Right(b)$é‚£ä¹ˆ$Status(a) = Status(b)$</p><p><strong>æ€§è´¨2</strong> ä¸€ä¸ªçŠ¶æ€$s$è¡¨ç¤ºçš„æ‰€æœ‰å­ä¸²$Right$é›†åˆç›¸åŒ,ä¸º$Right(s)$.</p><p>æ‰€ä»¥è¯´ç»™å®šäº†ä¸€ä¸ª$Right(s)$ä»¥åŠå­ä¸²çš„é•¿åº¦ æˆ‘ä»¬å°±å¯ä»¥å”¯ä¸€ç¡®å®šè¿™ä¸ªå­ä¸²$s$.</p><p><strong>æ€§è´¨3</strong> ä¸€ä¸ª$Right$é›†åˆå’Œä¸€ä¸ªé•¿åº¦å®šä¹‰äº†ä¸€ä¸ªå­ä¸²ã€‚</p><p><strong>æ€§è´¨4</strong> å¯¹äºçŠ¶æ€$s$ï¼Œä½¿å¾—$Right(s)$åˆæ³•çš„å­ä¸²é•¿åº¦æ˜¯ä¸€ä¸ªåŒºé—´ï¼Œä¸å¦¨å®šä¹‰ä¸º$[Min(s),Max(s)]$</p><p><strong>æ€§è´¨5</strong> $Right$é›†åˆçš„åŒ…å«å…³ç³»å½¢æˆçš„æ ‘å½¢ç»“æ„å«åš <strong>Parent Tree</strong>      </p><p>å…¶ä»–æ–‡çŒ®ä¸­å«åš$Suffix Link$è¿™ä¸ªè¾¹æ˜¯ä»å­©å­æŒ‡å‘çˆ¶äº²çš„ï¼Œå’ŒACè‡ªåŠ¨æœºçš„Fail Treeæœ‰ç‚¹åƒ</p><p><strong>æ€§è´¨6</strong> <strong>Parentæ ‘ä»ä¸Šå¾€ä¸‹Righté›†åˆå˜å°ï¼Œå­ä¸²é•¿åº¦å˜é•¿</strong> </p><p>Parent Treeçš„å¶å­èŠ‚ç‚¹æ•°$O(N)$ï¼Œæ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹è‡³å°‘ä¸¤ä¸ªå­©å­ï¼Œæ‰€ä»¥æ€»ç»“ç‚¹æ•°$O(N) $</p><p><del>å·®ä¸å¤šè¿™äº›å°±å·²ç»å¤Ÿäº†ï¼Ÿ</del></p><p>ä¸€äº›æ¨è®º</p><p>å¯ä»¥è¯æ˜ï¼Œåœ¨SAMä¸­èŠ‚ç‚¹æ•°ä¸è¶…è¿‡$2nâˆ’2$ï¼Œè¾¹æ•°ä¸è¶…è¿‡$3nâˆ’3$ï¼ˆåŒ…æ‹¬è½¬ç§»è¾¹å’ŒParent Treeçš„è¾¹ï¼‰ </p><p><strong>æ€§è´¨7</strong>$Suffix Link$ä»çˆ¶äº²æŒ‡å‘å„¿å­åå°±æ˜¯$Reverse(s)$ çš„$Suffix Tree$  åå‘å­—ç¬¦ä¸²çš„<strong>åç¼€æ ‘</strong>ï¼åç¼€æ ‘æ˜¯ä¸€é¢—ç»è¿‡å‹ç¼©çš„å­—å…¸æ ‘ </p><p><strong>æ€§è´¨8</strong> (æ„Ÿè§‰è¿™ä¸ªå¥½ç¥å•Š) ä¸¤ä¸ªä¸²çš„æœ€é•¿å…¬å…±åç¼€,ä½äºè¿™ä¸¤ä¸ªä¸²å¯¹åº”çŠ¶æ€åœ¨$Parent$æ ‘ä¸Šçš„æœ€è¿‘å…¬å…±ç¥–å…ˆçŠ¶æ€</p><p>å…¶ä»–è¿˜æœ‰ä¸€äº›å¯ä»¥å‘æ˜å•Š æ¯”å¦‚$Max$å’Œ$Min$çš„å…³ç³»ä»€ä¹ˆçš„â€¦</p><h3 id="å»ºç«‹SAM"><a href="#å»ºç«‹SAM" class="headerlink" title="å»ºç«‹SAM"></a>å»ºç«‹SAM</h3><p>$SAM$é‡‡ç”¨çš„æ˜¯åœ¨çº¿é€ä¸ªåŠ å…¥å­—ç¬¦çš„æ–¹æ³•</p><p>ç®€å•æ¥è¯´åˆ†è¿™å‡ ä¸ªé˜¶æ®µ</p><ol><li><p>å‡è®¾å½“å‰$T$çš„ä¸²é•¿åº¦ä¸º$L$,ç°åœ¨æ–°åŠ å…¥ä¸€ä¸ª$x$</p><p>$p = Status(T),Right(p) = L$</p></li><li><p>æ–°å»ºä¸€ä¸ª$np = ST(T+x)$(åŠ æ³•ä¸ºå­—ç¬¦ä¸²çš„åŠ æ³•)</p><p>é‚£ä¹ˆ$p$çš„$Parent$ç¥–å…ˆçš„$Right$é›†åˆé‡Œéƒ½æœ‰$L$</p><p>å‘ä¸Šæ›´æ–°$trans(v,x)$,ä¹Ÿå°±æ˜¯æ²¡æœ‰å­—ç¬¦$x$çš„ç¥–å…ˆéƒ½éœ€è¦æ›´æ–°,ä»è¿™ä¸ªçŠ¶æ€$last$è¦å‘å½“å‰æ–°çŠ¶æ€$np$æ·»åŠ è½¬ç§»</p><p>ä¹Ÿå°±æ˜¯$trans[last].ch[x] = np$</p></li><li><p>åˆ†ç±»è®¨è®ºæœ€åç¥–å…ˆçš„æƒ…å†µ</p><p>(1)å¦‚æœæœ€åæŸ¥æ‰¾åˆ°äº†$root$,ä¹Ÿå°±æ˜¯æ ¹èŠ‚ç‚¹ æˆ‘ä»¬ç›´æ¥å°†å®ƒçš„$Parent$è¾¹è¿å‘$root$</p><p>(2)æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰çš„ç¥–å…ˆä¸º$p$,ä»¤$q = trans[p].ch[x]$</p><p>å†åˆ†ç±»ä¸€æ³¢</p><p>â€‹    (i)å¦‚æœè¯´æ»¡è¶³äº†$t[q].val=t[p].val+1$ è¯´æ˜å¼ºè¡ŒåŠ å…¥è¿™ä¸ª$L+1$ä¸ä¼šä½¿å¾—$Max(q)$å‡å° ç›´æ¥è¿è¾¹</p><p>â€‹    (ii)ä¸æ»¡è¶³ æˆ‘ä»¬è€ƒè™‘æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹$nq$,$nq$æœ¬è´¨ä¸Šé™¤äº†$Max$ä¸åŒ,å…¶ä»–ä¿¡æ¯å‡ç›¸åŒ,å°†$np$,$q$çš„$parent$å‡è¿å‘$nq$</p></li></ol><p><del>ä»£ç å®ç°è¿˜æ˜¯æ¯”è¾ƒå¯è¯»çš„å§â€¦</del></p><h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sam</span>&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> ch[<span class="number">26</span>],par,val; <span class="comment">//par -&gt; parent | val -&gt; Max</span></span><br><span class="line">    &#125;t[N];</span><br><span class="line">    <span class="keyword">int</span> c[N],a[N],siz[N]; <span class="comment">//è¿™ä¸€è¡Œè¾…åŠ©æ•°ç»„</span></span><br><span class="line">    <span class="keyword">int</span> sz,root,last;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;sz=root=last=<span class="number">1</span>;&#125; <span class="comment">//å®šä¹‰æ ¹èŠ‚ç‚¹ä¸º1</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p=last,np=++sz;<span class="comment">//æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        t[np].val=t[p].val+<span class="number">1</span>;<span class="comment">//é•¿åº¦ä¸ºä¸Šä¸€ä¸ªèŠ‚ç‚¹é•¿åº¦+1</span></span><br><span class="line">        <span class="keyword">for</span>(;p&amp;&amp;!t[p].ch[x];p=t[p].par) t[p].ch[x]=np;<span class="comment">//å‘ä¸Šç¥–å…ˆæ›´æ”¹ch[x]</span></span><br><span class="line">        <span class="keyword">if</span>(!p) t[np].par=root;<span class="comment">//å¦‚æœæœ€ç»ˆä¸ºæ ¹èŠ‚ç‚¹ç›´æ¥å°†parentè¾¹è¿å‘root</span></span><br><span class="line">        <span class="keyword">else</span>&#123;<span class="comment">//åˆ†ç±»è®¨è®º</span></span><br><span class="line">            <span class="keyword">int</span> q=t[p].ch[x];</span><br><span class="line">            <span class="keyword">if</span>(t[q].val==t[p].val+<span class="number">1</span>) t[np].par=q;<span class="comment">//æ»¡è¶³Max(q) = Max(p) + 1</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> nq=++sz;<span class="comment">//æ–°å»ºnqèŠ‚ç‚¹</span></span><br><span class="line">                t[nq]=t[q];<span class="comment">//æ‹·è´èŠ‚ç‚¹qçš„ä¿¡æ¯</span></span><br><span class="line">                t[nq].val=t[p].val+<span class="number">1</span>;<span class="comment">//nqå’Œpå”¯ä¸€çš„ä¸åŒMax</span></span><br><span class="line">                t[q].par=t[np].par=nq;<span class="comment">//ä¹Ÿæ˜¯æ‹·è´ä¿¡æ¯</span></span><br><span class="line">                <span class="keyword">for</span>(;p&amp;&amp;t[p].ch[x]==q;p=t[p].par) t[p].ch[x]=nq;<span class="comment">//æ‹·è´ä¿¡æ¯</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        last=np;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123; <span class="comment">//åšå…¶ä»–äº‹çš„æ—¶å€™å¯èƒ½ä¼šç”¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sz; ++i) c[t[i].val]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sz; ++i) c[i] += c[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sz; ++i) a[--c[t[i].val]] = i; <span class="comment">//è¿™é‡Œæ˜¯åŸºæ•°æ’åºå¯¹parentè¾¹ä½œæ‹“æ‰‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;sam;</span><br></pre></td></tr></table></figure><h3 id="é¢˜å•"><a href="#é¢˜å•" class="headerlink" title="é¢˜å•"></a>é¢˜å•</h3><p><strong>spoj8222</strong> åç¼€è‡ªåŠ¨æœºæ¨¡æ¿(spoj8222) </p><p><strong>BZOJ3998</strong> ç¬¬Kå¤§å­ä¸²ï¼Œç»´æŠ¤valå’Œsum </p><p><strong>NOI2015å“é…’å¤§ä¼š</strong> ç”¨åç¼€è‡ªåŠ¨æœºå»ºå‡ºåç¼€æ ‘ï¼Œç„¶åå°±å˜æˆäº†åç¼€æ ‘è£¸é¢˜ </p><p><strong>BZOJ4545</strong> åç¼€è‡ªåŠ¨æœº+æœ‰å‘LCT </p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;åç¼€è‡ªåŠ¨æœº-Suffix-Automaton-SAM&quot;&gt;&lt;a href=&quot;#åç¼€è‡ªåŠ¨æœº-Suffix-Automaton-SAM&quot; class=&quot;headerlink&quot; title=&quot;åç¼€è‡ªåŠ¨æœº Suffix Automaton (SAM)&quot;&gt;&lt;/a&gt;åç¼€è‡ªåŠ¨æœº Suffix Automaton (SAM)&lt;/h2&gt;
    
    </summary>
    
      <category term="å­—ç¬¦ä¸²" scheme="http://yoursite.com/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒCF743Dã€Chloe and pleasant prizes</title>
    <link href="http://yoursite.com/2018/07/22/%E3%80%8CCF743D%E3%80%8DChloe-and-pleasant-prizes/"/>
    <id>http://yoursite.com/2018/07/22/ã€ŒCF743Dã€Chloe-and-pleasant-prizes/</id>
    <published>2018-07-22T03:05:01.000Z</published>
    <updated>2018-07-22T03:09:55.692Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="http://codeforces.com/contest/743/problem/D" target="_blank" rel="noopener">CF734D</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>æ±‚æœ€å¤§çš„ä¸¤å­æ ‘æƒå€¼ä¹‹å’Œ,è¦æ±‚å­æ ‘æ²¡æœ‰äº¤é›†</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>çœŸÂ·æ–¯æ³¢é¢˜,ç›´æ¥ç»Ÿè®¡æœ€å¤§å­æ ‘å’Œæ¬¡å¤§å­æ ‘å³å¯.</p><p>ç‰¹åˆ¤ä¸€æ¡é“¾çš„æƒ…å†µ æ˜¯ä¸å¯èƒ½æœ‰ç­”æ¡ˆçš„.</p><p>æ¶å¿ƒçš„infå¼„æˆ‘åŠå¤©</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f3f3f3f3f</span>LL;</span><br><span class="line"><span class="keyword">int</span> n,w[MAXN],fa[MAXN],dp[MAXN],head[MAXN],sz[MAXN],cnt,flag=<span class="number">0</span>,ans=-inf;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,nxt;</span><br><span class="line">&#125;E[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    E[++cnt].nxt = head[u]; E[cnt].to = v; head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cur = -inf;</span><br><span class="line">    fa[u] = f;</span><br><span class="line">    dp[u] = -inf;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = E[i].nxt)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = E[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa[u]) <span class="keyword">continue</span>;</span><br><span class="line">        ++sz[u];</span><br><span class="line">        dfs(v,u);</span><br><span class="line">        w[u] += w[v];</span><br><span class="line">        dp[u] = max(dp[u],dp[v]);</span><br><span class="line">        <span class="keyword">if</span> (sz[u] &gt; <span class="number">1</span>) flag = <span class="number">1</span>;</span><br><span class="line">        ans = max(ans,cur + dp[v]);</span><br><span class="line">        cur = max(cur,dp[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    dp[u] = max(dp[u],w[u]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n) w[i]=read();</span><br><span class="line">    rep(i,<span class="number">1</span>,n<span class="number">-1</span>) &#123;<span class="keyword">int</span> u=read(),v=read(); addedge(u,v); addedge(v,u);&#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> (!flag) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"Impossible"</span>),<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans),<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;http://codeforces.com/contest/743/problem/D&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CF734D&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Codeforces" scheme="http://yoursite.com/categories/Codeforces/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒCF696Bã€Puzzles æ ‘ä¸ŠæœŸæœ›DP</title>
    <link href="http://yoursite.com/2018/07/22/%E3%80%8CCF696B%E3%80%8DPuzzles-%E6%A0%91%E4%B8%8A%E6%9C%9F%E6%9C%9BDP/"/>
    <id>http://yoursite.com/2018/07/22/ã€ŒCF696Bã€Puzzles-æ ‘ä¸ŠæœŸæœ›DP/</id>
    <published>2018-07-22T02:32:38.000Z</published>
    <updated>2018-07-22T03:08:40.204Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="http://codeforces.com/contest/696/problem/B" target="_blank" rel="noopener">CF696B</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä¸€æ£µæ ‘,æ ¹æ®$dfs(x)$ä¸­$x$çš„ä¸åŒ,æ¯ä¸ªèŠ‚ç‚¹çš„$dfn(i)$ä¹Ÿä¼šä¸åŒ,æ±‚$dfs(i),i \in[1,n]$ä¸­$dfn(i)$çš„æœŸæœ›.</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è¿˜æ˜¯å»è€ƒè™‘æ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹å¤§æ³•å¸ˆæ—¶å¯¹å…¶ä»–ç‚¹çš„è´¡çŒ®.</p><p>æˆ‘ä»¬ä¸å¦‚è€ƒè™‘ä¸€é¢—å­æ ‘.å·²çŸ¥èŠ‚ç‚¹$u$çš„æœŸæœ›$ans[u]=1.0$</p><p>å¯¹äºå‰©ä¸‹çš„ç‚¹è€ƒè™‘$dfn$çš„æ’åˆ—å¯ä»¥æ˜¯ç›´æ¥ä»$u$åˆ°è¾¾,åˆ™$ans[v] += ans[u] + 1.0$</p><p>æˆ–è€…æ˜¯ç»è¿‡$u$çš„å…¶ä»–å„¿å­ä¸”æ’åœ¨èŠ‚ç‚¹$v$å‰é¢çš„å„¿å­çš„æ¥.</p><p>ä¸éš¾å‘ç°æ¯æ¬¡å¯¹äºä»»æ„$u$çš„å„¿å­$a,b$æ»¡è¶³$dfn(a)&gt;dfn(b)$çš„æ¦‚ç‡ä¸º$\frac{1}{2}$</p><p>æ‰€ä»¥ç¬¬äºŒéƒ¨åˆ†$ans[v] += (å…¶ä»–èŠ‚ç‚¹æ€»æ•°) * 0.5$</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,nxt;</span><br><span class="line">&#125;E[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],sz[MAXN],cnt = <span class="number">0</span>,n;</span><br><span class="line"><span class="keyword">double</span> ans[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    E[++cnt].nxt = head[u]; E[cnt].to = v; head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=head[u],v; i; i=E[i].nxt)&#123;</span><br><span class="line">        v=E[i].to;</span><br><span class="line">        <span class="comment">//if (v != fa) </span></span><br><span class="line">        dfs(v,u);</span><br><span class="line">        sz[u] += sz[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=head[u],v; i; i=E[i].nxt)&#123;</span><br><span class="line">        v=E[i].to;</span><br><span class="line">        <span class="comment">//if(v==f)continue;</span></span><br><span class="line">        ans[v]=ans[u]+<span class="number">1.0</span>+(sz[u]-sz[v]<span class="number">-1</span>)*<span class="number">0.5</span>;</span><br><span class="line">        dfs2(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    rep(i,<span class="number">2</span>,n) &#123;</span><br><span class="line">        <span class="keyword">int</span> t=read();</span><br><span class="line">        addedge(t,i);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    ans[<span class="number">1</span>] = <span class="number">1.0</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    rep(i,<span class="number">1</span>,n) <span class="built_in">printf</span>(<span class="string">"%.7lf "</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;http://codeforces.com/contest/696/problem/B&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CF696B&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Codeforces" scheme="http://yoursite.com/categories/Codeforces/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒZOJ3626ã€Treasure Hunt I æ ‘ä¸ŠèƒŒåŒ…</title>
    <link href="http://yoursite.com/2018/07/22/%E3%80%8CZOJ3626%E3%80%8DTreasure-Hunt-I-%E6%A0%91%E4%B8%8A%E8%83%8C%E5%8C%85/"/>
    <id>http://yoursite.com/2018/07/22/ã€ŒZOJ3626ã€Treasure-Hunt-I-æ ‘ä¸ŠèƒŒåŒ…/</id>
    <published>2018-07-22T02:12:04.000Z</published>
    <updated>2018-07-22T15:16:46.965Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemCode=3626" target="_blank" rel="noopener">ZOJ3626</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä¸€æ£µæ ‘æ¯æ¡è¾¹ä¸Šæœ‰èŠ±è´¹å€¼$cost_i$,æ¯ä¸ªç‚¹ä¸Šæœ‰æƒå€¼$w_i$,æ±‚ä»¥$k$ä¸ºèµ·ç‚¹,èŠ±è´¹å°äº$m$,å¹¶æœ€ç»ˆå›åˆ°èµ·ç‚¹$k$,èƒ½å¾—åˆ°çš„æœ€å¤§æƒå€¼</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>æ ‘ä¸Šçš„èƒŒåŒ…dp</p><p>ä»¤$f[i][j]$è¡¨ç¤ºä»$i$ä¸ºèµ·ç‚¹,èŠ±è´¹$j$æ‰€å¯ä»¥å¾—åˆ°çš„æœ€å¤§æƒå€¼.æœ‰ä¸¤ç§å†³ç­–å¯¹äº$i$çš„å­©å­$v$,è¦ä¹ˆä¸èµ°,è¦ä¹ˆèŠ±è´¹$cost_{i \space to \space v}$</p><p>æ‰€ä»¥æœ‰$f[i][j]=max(f[i][j],f[v][k]+f[i][j-cost-k])$</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">110</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,nxt,cost;</span><br><span class="line">&#125;E[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> n,m,k,head[MAXN],w[MAXN],vis[MAXN],cnt,ans;</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">2010</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    E[++cnt].nxt = head[u]; E[cnt].to = v; E[cnt].cost = w; head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    vis[u]=<span class="number">1</span>;</span><br><span class="line">    f[u][<span class="number">0</span>] = w[u];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = E[i].nxt)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = E[i].to,cost = E[i].cost;</span><br><span class="line">        <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">            dfs(v);</span><br><span class="line">            per(j,m,<span class="number">0</span>) rep(k,<span class="number">0</span>,j-cost)</span><br><span class="line">            f[u][j]=max(f[v][k]+f[u][j-k-cost],f[u][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n) == <span class="number">1</span>)&#123;</span><br><span class="line">        cnt=<span class="number">0</span>;ans=<span class="number">-1</span>;MM(vis,<span class="number">0</span>);MM(head,<span class="number">0</span>);MM(f,<span class="number">0</span>);</span><br><span class="line">        rep(i,<span class="number">1</span>,n) w[i]=read();</span><br><span class="line">        rep(i,<span class="number">1</span>,n<span class="number">-1</span>) &#123;<span class="keyword">int</span> u=read(),v=read(),w=read(); addedge(u,v,w); addedge(v,u,w);&#125;</span><br><span class="line">        k=read(),m=read()&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        dfs(k);</span><br><span class="line">        rep(i,<span class="number">0</span>,m) ans=max(ans,f[k][i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemCode=3626&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ZOJ3626&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="DP-æ ‘å½¢DP" scheme="http://yoursite.com/categories/DP-%E6%A0%91%E5%BD%A2DP/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒCF1006Fã€Xor-Paths Meet-in-the-middle</title>
    <link href="http://yoursite.com/2018/07/21/%E3%80%8CCF1006F%E3%80%8DXor-Paths-Meet-in-the-middle/"/>
    <id>http://yoursite.com/2018/07/21/ã€ŒCF1006Fã€Xor-Paths-Meet-in-the-middle/</id>
    <published>2018-07-21T14:43:36.000Z</published>
    <updated>2018-07-21T14:46:48.187Z</updated>
    
    <content type="html"><![CDATA[<p><del>(ç¬¬ä¸€ä»½å±¯é¢˜è®¡åˆ’?)</del></p><p>Links there:<a href="http://codeforces.com/problemset/problem/1006/F" target="_blank" rel="noopener">CF1006F</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™å®šä¸€ä¸ª$n \times m$çš„çŸ©é˜µ,ä»èµ·ç‚¹$(1,1)$èµ·æ­¥åˆ°$(n,m)$,æ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³èµ°.</p><p>æ±‚æ‰€æœ‰æ»¡è¶³è·¯å¾„ä¸Šçš„å¼‚æˆ–å’Œä¸º $k$ çš„è·¯å¾„æ¡æ•°.</p><p>$ n,m \leq 20 ,\space k\leq 1e18$</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>é‡‡ç”¨ä¸­é—´ç›¸é‡çš„æ–¹æ³•.æ˜¾ç„¶æ¯æ¬¡ä»$(1,1)$ åˆ° $(n,m)$ éœ€è¦èµ°$(n+m-2)$æ­¥.å‰ä¸€åŠæš´åŠ›å¤§æ³•å¸ˆ.åä¸€åŠç›´æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥å¼‚æˆ–åˆ°$k$å³å¯.$k$å¾ˆå¤§çš„è¯ä¸å¦‚å¼€ä¸ª$map$.</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line"><span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">25</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;cnt[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> a[MAXN][MAXN],ans=<span class="number">0</span>,n,m,k,h;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> val,<span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">1</span> || x &gt; n || y &lt; <span class="number">1</span> || y &gt; m) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> cur = val ^ a[x][y];</span><br><span class="line">    <span class="keyword">if</span> (x+y == h+<span class="number">2</span>) &#123;</span><br><span class="line">         ++cnt[x][y][cur];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(x+<span class="number">1</span>,y,cur,step+<span class="number">1</span>);</span><br><span class="line">    dfs(x,y+<span class="number">1</span>,cur,step+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> val,<span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">1</span> || x &gt; n || y &lt; <span class="number">1</span> || y &gt; m) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> cur = val ^ a[x][y];</span><br><span class="line">    <span class="keyword">if</span> (x+y == h+<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cnt[x][y][val^k]) ans += cnt[x][y][val^k];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs2(x<span class="number">-1</span>,y,cur,step+<span class="number">1</span>);</span><br><span class="line">    dfs2(x,y<span class="number">-1</span>,cur,step+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    n=read(),m=read(),k=read();</span><br><span class="line">    h=(n+m<span class="number">-2</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,n) rep(j,<span class="number">1</span>,m) a[i][j]=read();</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    dfs2(n,m,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3 11</span></span><br><span class="line"><span class="comment">2 1 5</span></span><br><span class="line"><span class="comment">7 10 0</span></span><br><span class="line"><span class="comment">12 6 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;del&gt;(ç¬¬ä¸€ä»½å±¯é¢˜è®¡åˆ’?)&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;Links there:&lt;a href=&quot;http://codeforces.com/problemset/problem/1006/F&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CF1006F&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Codeforces" scheme="http://yoursite.com/categories/Codeforces/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€Œå±¯é¢˜è®¡åˆ’ã€Codeforces æ³›åš</title>
    <link href="http://yoursite.com/2018/07/21/%E3%80%8C%E5%B1%AF%E9%A2%98%E8%AE%A1%E5%88%92%E3%80%8DCodeforces-%E6%B3%9B%E5%81%9A/"/>
    <id>http://yoursite.com/2018/07/21/ã€Œå±¯é¢˜è®¡åˆ’ã€Codeforces-æ³›åš/</id>
    <published>2018-07-21T13:26:37.000Z</published>
    <updated>2018-07-22T03:10:21.986Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ä¹Ÿç®—æ˜¯ä¸ªè„‘å­åº·å¤è®­ç»ƒå§ã€‚</strong></p><p>è’Ÿè’»ä¸åšé¢˜æå‰é€€å½¹ã€‚è’Ÿè’»ä¸æ’•çƒ¤æ™ºç†µä½•æ¥ï¼Ÿè’Ÿè’»ä¸åçœå¤©å¤©è¢«Dã€‚</p><p><strong>Codeforces:</strong></p><center><font color="#dd00dd"><font size="10"><font face="fantasy"> 3 / 50 </font> </font><br>  </font><br></center> ]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;ä¹Ÿç®—æ˜¯ä¸ªè„‘å­åº·å¤è®­ç»ƒå§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è’Ÿè’»ä¸åšé¢˜æå‰é€€å½¹ã€‚è’Ÿè’»ä¸æ’•çƒ¤æ™ºç†µä½•æ¥ï¼Ÿè’Ÿè’»ä¸åçœå¤©å¤©è¢«Dã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Codeforces:&lt;/strong&gt;&lt;/p&gt;
&lt;center&gt;&lt;font color=&quot;#dd00dd&quot;
      
    
    </summary>
    
      <category term="å±¯é¢˜è®¡åˆ’" scheme="http://yoursite.com/categories/%E5%B1%AF%E9%A2%98%E8%AE%A1%E5%88%92/"/>
    
    
      <category term="Codeforces" scheme="http://yoursite.com/tags/Codeforces/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒBZOJ5028ã€å°Zçš„åŠ æ²¹åº— å·®åˆ† çº¿æ®µæ ‘å•ç‚¹ä¿®æ”¹åŒºé—´æ±‚gcd</title>
    <link href="http://yoursite.com/2018/07/21/%E3%80%8CBZOJ5028%E3%80%8D%E5%B0%8FZ%E7%9A%84%E5%8A%A0%E6%B2%B9%E5%BA%97-%E5%B7%AE%E5%88%86-%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%B1%82gcd/"/>
    <id>http://yoursite.com/2018/07/21/ã€ŒBZOJ5028ã€å°Zçš„åŠ æ²¹åº—-å·®åˆ†-çº¿æ®µæ ‘å•ç‚¹ä¿®æ”¹åŒºé—´æ±‚gcd/</id>
    <published>2018-07-21T10:25:26.000Z</published>
    <updated>2018-07-21T10:30:39.051Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=5028" target="_blank" rel="noopener">BZOJ5028</a></p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>å‚è§ä¼ é€é—¨(<del>æ‡’å¾—å†™äº†</del>)</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è€ƒè¯•æ—¶çš„æˆ‘:â€mdæ€ä¹ˆæå•Š åº”è¯¥æ˜¯æ±‚ä¸ªåŒºé—´gcdå§ é‚£è¿™æ ·çš„è¯åŠ æ ‡è®°å¯¹æ±‚gcdæœ‰å½±å“æ€ä¹ˆç®—å•Š ä¸ä¼šä¸æ˜¯çº¿æ®µæ ‘è¿™ä¸ªä¸œè¥¿å§ ä¼šä¸ä¼šæ˜¯åˆ†å—å•Š éš¾é“è¿˜æœ‰å…¶ä»–å§¿åŠ¿å—â€¦â€</p><p>è¯¶ é‚£ä¹ˆå·®åˆ†ä¸€ä¸‹ä¸ä¹…å®Œäº‹äº†!å¤šå¼€ä¸ªçº¿æ®µæ ‘æˆ–è€…æ ‘çŠ¶æ•°ç»„è®°å½•åŸåºåˆ—å°±å¥½äº†å•Š!</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) (x&amp;-x)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc o&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc o&lt;&lt;1|1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,B[N],ans[<span class="number">4</span>*N],C[<span class="number">4</span>*N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> v)</span></span>&#123;<span class="keyword">for</span>(<span class="keyword">int</span> i = p;i &lt; N;i += lowbit(i)) C[i] += v;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret = <span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">int</span> i = p;i;i -= lowbit(i)) ret += C[i];<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">int</span> _gcd(<span class="keyword">int</span> a,<span class="keyword">int</span> b)&#123;a=<span class="built_in">abs</span>(a);b=<span class="built_in">abs</span>(b);<span class="keyword">return</span> __gcd(a,b);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;ans[o] = B[l] - B[l - <span class="number">1</span>];<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(lc,l,mid);build(rc,mid + <span class="number">1</span>,r);</span><br><span class="line">    ans[o] = _gcd(ans[lc],ans[rc]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;ans[o] += v;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p &lt;= mid) modify(lc,l,mid,p,v);</span><br><span class="line">    <span class="keyword">else</span> modify(rc,mid + <span class="number">1</span>,r,p,v);</span><br><span class="line">    ans[o] = _gcd(ans[lc],ans[rc]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == L &amp;&amp; r == R) <span class="keyword">return</span> ans[o];</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(R &lt;= mid) <span class="keyword">return</span> query(lc,l,mid,L,R);</span><br><span class="line">    <span class="keyword">if</span>(L &gt; mid) <span class="keyword">return</span> query(rc,mid + <span class="number">1</span>,r,L,R);</span><br><span class="line">    <span class="keyword">return</span> _gcd(query(lc,l,mid,L,mid),query(rc,mid + <span class="number">1</span>,r,mid + <span class="number">1</span>,R));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// freopen("bucket.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("bucket.out","w",stdout);</span></span><br><span class="line">    n = read(),m = read();</span><br><span class="line">    MM(B,<span class="number">0</span>);MM(C,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        B[i] = read();</span><br><span class="line">        add(i,B[i]);</span><br><span class="line">        add(i + <span class="number">1</span>,-B[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    build(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="keyword">int</span> opt = read(),l = read(),r = read(),v;</span><br><span class="line">        <span class="keyword">if</span>(opt == <span class="number">1</span>)&#123;</span><br><span class="line">            v = read();</span><br><span class="line">            modify(<span class="number">1</span>,<span class="number">1</span>,n,l,v);</span><br><span class="line">            <span class="keyword">if</span>(r &lt; n)</span><br><span class="line">            modify(<span class="number">1</span>,<span class="number">1</span>,n,r + <span class="number">1</span>,-v);</span><br><span class="line">            add(l,v);</span><br><span class="line">            add(r + <span class="number">1</span>,-v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,sum(l));</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,_gcd(query(<span class="number">1</span>,<span class="number">1</span>,n,l + <span class="number">1</span>,r),sum(r)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// fclose(stdin); fclose(stdout);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;https://www.lydsy.com/JudgeOnline/problem.php?id=5028&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BZOJ5028&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çº¿æ®µæ ‘" scheme="http://yoursite.com/categories/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒHDU1290ã€(åŠ å¼º) æ•°å­¦ é€’æ¨</title>
    <link href="http://yoursite.com/2018/07/21/HDU1290-%E5%8A%A0%E5%BC%BA/"/>
    <id>http://yoursite.com/2018/07/21/HDU1290-åŠ å¼º/</id>
    <published>2018-07-21T10:05:37.000Z</published>
    <updated>2018-07-21T10:23:17.803Z</updated>
    
    <content type="html"><![CDATA[<p>Links there:<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1290" target="_blank" rel="noopener">HDU1290</a>(å¼±åŒ–ç‰ˆ)</p><a id="more"></a><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä¸€ä¸ªçƒ,æŠŠçƒåˆ‡ $N$ åˆ€(å…è®¸å„ä¸ªæ–¹å‘ä½†æ˜¯å¿…é¡»ç›´çº¿åˆ‡),é—®æœ€å¤šå¯ä»¥åˆ†æˆå¤šå°‘å—(å¯¹$1e9+7$å–æ¨¡).</p><p>åŠ å¼º,$N \leq 1,000,000,000$</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>ä»¤$f(n)$è¡¨ç¤ºç­”æ¡ˆ,æ—¢æœ€å¤šå¯ä»¥åˆ†æˆçš„å—æ•°,$d(n)$è¡¨ç¤ºäºŒç»´å¹³é¢å†… $N$ æ¡ç›´çº¿åˆ†æˆçš„å—æ•°</p><p>è€ƒè™‘$f(n)$ä¸$f(n-1)$çš„å…³ç³»,ç›¸å½“äºåœ¨$f(n-1)$çš„åŸºç¡€ä¸Šå†åœ¨ä¸€ä¸ªå¹³é¢å†…å¤šåˆ†å‡º$d(n-1)$å—</p><p>æ‰€ä»¥æœ‰$f(n)=f(n-1)+d(n-1)$</p><p>$d(n-1) = 1+\frac{(n-1)\times n}{2}$ (è¿™ä¸ªåº”è¯¥å°å­¦å¥¥æ•°å°±æ•™è¿‡å§..æ‰¾ä¸€ä¸‹è§„å¾‹å°±è¡Œäº†)</p><p>æ‰€ä»¥$f(n) = f(1) + \sum_{i=1}^{n-1}d(i)$</p><p>æ˜æ˜¾$f(1)=2$</p><p>$f(n)=2+(n-1)+\sum<em>{i=2}^{n}\frac{n^2}{2}-\sum</em>{i=2}^{n}\frac{n}{2}$</p><p>è¯¶æˆ‘ä»¬ä¼¼ä¹å‘ç°æŠŠåé¢ä¸¤ä¸ª$\sum$ä¸­$i$ä¸‹æ ‡ä»1å¼€å§‹å¯¹ç­”æ¡ˆæ²¡æœ‰å½±å“è€Œä¸”ä¼¼ä¹æ›´ä¼˜ç¾äº†!</p><p>$\therefore f(n) = n+1+\frac{n\times (n+1) \times (2n+1)}{12}+\frac{(1+n)\times n}{4}$</p><p>äºæ˜¯æ±‚ä¸€ä¸‹é€†å…ƒå•Šä»€ä¹ˆçš„å°±è§£å†³äº†å•Š</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//my vegetable has exploded. :(</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) (x&gt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(x,y) (x&lt;y?x:y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM(x,y) memset(x,y,sizeof(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MCPY(a,b) memcpy(a,b,sizeof(b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,b,a) for(int i=b;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">quickpow</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> b=<span class="number">1</span>;<span class="keyword">while</span>(n)&#123;<span class="keyword">if</span>(n&amp;<span class="number">1</span>)b=b*m%p;n=n&gt;&gt;<span class="number">1</span>;m=m*m%p;&#125;<span class="keyword">return</span> b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">return</span> quickpow(x,p<span class="number">-2</span>,p);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))&#123;f=ch==<span class="string">'-'</span>?<span class="number">-1</span>:<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="comment">///------------------head------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">signed</span> argc,<span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    freopen(<span class="string">"melon.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"melon.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line">    rep(i,<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n=read();</span><br><span class="line">        <span class="keyword">int</span> ans=(<span class="number">1</span>+n+(getinv(<span class="number">12</span>,Mod) * n % Mod * (n+<span class="number">1</span>) % Mod * (<span class="number">2</span>*n+<span class="number">1</span>) % Mod) - (getinv(<span class="number">4</span>,Mod) * n % Mod * (n+<span class="number">1</span>) % Mod) + Mod) % Mod;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(<span class="built_in">stdin</span>); fclose(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Examples: */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Links there:&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=1290&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;HDU1290&lt;/a&gt;(å¼±åŒ–ç‰ˆ)&lt;/p&gt;
    
    </summary>
    
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="http://yoursite.com/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
</feed>
